import{s as C,_ as E}from"./BNGNi11G.js";import{X as N,Y as $,as as j,ai as U,a9 as L,ab as A,O as n,Q as v,a4 as R,ac as t,R as r,T as _,a6 as V,U as S,S as I,ae as M,a1 as q,a5 as d,V as J,al as O,af as D,ak as P,Z as T,a8 as G,$ as K,ag as Q,at as X}from"./D_GAU_kb.js";const Y={class:"shrink-0"},Z={class:"p-small micro:p-normal relative flex-1 rounded rounded-tl-none border-2 border-(--colorBorder) bg-(--colorBg)"},F={class:"gap-small flex flex-col font-serif text-(--colorText)"},H={class:"text-main-sm gap-normal flex flex-wrap font-semibold"},W={class:"flex-1"},ee={key:2},oe={key:0,class:"gap-normal micro:text-[1.5em] flex items-center text-[1.2em]"},te=["title"],ae=N({__name:"MainQuote",props:{quote:{},canJoin:{type:Boolean},hasNextLink:{type:Boolean}},emits:["next"],async setup(o,{emit:c}){let l,x;const i=c,y=$(),k=j(),f=o.quote.color??C(o.quote.name),w=(()=>{const e=o.quote.type==="cameo"?o.quote.messages:[...o.quote.messages??[],...U.config.sponsors?.defaultSponsorMessages],a=Math.floor(Math.random()*e.length);return e[a]})(),g=o.quote.type==="cameo"||o.quote.avatarUrl?y(o.quote.avatarUrl):"diamond";function b(){i("next"),setTimeout(()=>{u.value=k},400)}const u=T("arrow/left"),p=([l,x]=L(()=>A("add_quote","next_quote")),l=await l,x(),l);return(e,a)=>{const m=E,s=V,h=P,B=O;return n(),v("div",{style:R({"--color":t(f),"--colorBorder":"color-mix(in srgb, var(--color), var(--color-border) 70%)","--colorBg":"color-mix(in srgb, var(--color), var(--color-bg-main) 85%)","--colorText":"color-mix(in srgb, var(--color), var(--color-text) 85%)","--colorIcon":"color-mix(in srgb, var(--color), var(--color-text) 30%)"}),class:"micro:gap-[40px] flex gap-[30px]"},[r("div",Y,[_(s,{external:"",target:"_blank",to:o.quote.link,class:"block rounded-full ring-2 ring-(--colorBorder)"},{default:S(()=>[_(m,{url:t(g),class:"border-bg-main micro:size-[60px] size-[40px] rounded-full border-2 [box-shadow:0_0_16px_0_var(--color)] [--mediaColor:var(--color)]"},null,8,["url"])]),_:1},8,["to"])]),r("div",Z,[a[0]||(a[0]=r("div",{class:"micro:[--arrowSize:22px] absolute -top-[2px] -left-(--arrowSize) h-(--arrowSize) w-(--arrowSize) bg-(--colorBorder) [--arrowSize:14px] [--arrowSizeSmall:calc(var(--arrowSize)-2px)] [clip-path:polygon(110%_0,110%_110%,0_0)]"},[r("div",{class:"absolute top-[2px] -right-[3px] h-(--arrowSizeSmall) w-(--arrowSizeSmall) bg-(--colorBg) [clip-path:polygon(100%_0,100%_100%,0_0)]"})],-1)),r("div",F,[r("div",null,I(("formatText"in e?e.formatText:t(M))(t(w))),1),r("div",H,[r("div",W,[o.quote.type==="cameo"||o.quote.avatarUrl?(n(),q(h,{key:0,class:"relative -top-[1.5px] mr-1.5 inline text-(--colorIcon)",name:o.quote.icon},null,8,["name"])):d("",!0),o.quote.link?(n(),q(s,{key:1,external:"",to:o.quote.link,target:"_blank",class:"text-hover-underline"},{default:S(()=>[J(I(("formatText"in e?e.formatText:t(M))(o.quote.name)),1)]),_:1},8,["to"])):(n(),v("span",ee,I(("formatText"in e?e.formatText:t(M))(o.quote.name)),1)),o.quote.link?(n(),q(B,{key:3,name:"arrow/outward",class:"relative -top-1 -right-1 inline text-(--colorText)/40"})):d("",!0)]),o.canJoin||o.hasNextLink?(n(),v("div",oe,[o.canJoin?(n(),q(s,{key:0,to:("PAGES"in e?e.PAGES:t(D)).sponsors,title:t(p).add_quote,class:"hocus:text-(--colorIcon) text-(--colorIcon)/40 transition-[color]"},{default:S(()=>[_(B,{name:"plus"})]),_:1},8,["to","title"])):d("",!0),o.hasNextLink?(n(),v("button",{key:1,onClick:b,title:t(p).next_quote,class:"hocus:text-(--colorIcon) cursor-pointer text-(--colorIcon)/40 transition-[color]"},[_(h,{name:t(u),class:"-scale-x-100"},null,8,["name"])],8,te)):d("",!0)])):d("",!0)])])])],4)}}}),ne=Object.assign(ae,{__name:"MainQuote"}),z="quote-ids",se=N({__name:"MainQuoteLoader",async setup(o){let c,l;const x=G(),i=x.static.data[z]||=x.payload.data[z]||=([c,l]=L(()=>$fetch("/api/quote/ids",{responseType:"json"})),c=await c,l(),c),y=Q(()=>Object.values(i).reduce((e,a)=>e+(a?.length??0),0)),k=Q(()=>y.value>1),f=T();function w(){const e=[];for(const s in i){const h=i[s];h&&e.push(...h)}if(e.length===1)return e[0];const a=f.value?e.filter(s=>s!==f.value):e,m=Math.floor(Math.random()*a.length);return a[m]}const g=X(),b=T(0);let u=!1;async function p(){u=!0;const e=w();f.value=e;const a=await $fetch(`/api/quote/data/${e}`,{responseType:"json"});g.value=a,b.value++,u=!1}return K(()=>{Object.keys(i).length!==0&&p()}),(e,a)=>{const m=ne;return t(g)?(n(),v("section",{key:t(b),class:"px-main py-main-half"},[_(m,{quote:t(g),canJoin:("ERUDIT"in e?e.ERUDIT:t(U)).config.sponsors?.enabled,hasNextLink:t(k),onNext:a[0]||(a[0]=s=>!t(u)&&p())},null,8,["quote","canJoin","hasNextLink"])])):d("",!0)}}}),ce=Object.assign(se,{__name:"MainQuoteLoader"});export{ce as _};
