import{s as C,_ as U}from"./CDF6NPZx.js";import{a as L,E as j,G as Q,U as I,n as N,C as E,e as v,k as r,R as $,h as t,f as s,v as _,Q as A,x as w,t as S,J as B,g as f,l as k,y as P,K as V,P as G,I as O,ak as R,B as K,c as T,s as D,o as J}from"./Co3pHHec.js";const F={class:"shrink-0"},H={class:"p-small micro:p-normal relative flex-1 rounded rounded-tl-none border-2 border-(--colorBorder) bg-(--colorBg) transition-[background,border]"},W={class:"gap-small flex flex-col font-serif text-(--colorText)"},X={class:"text-main-sm gap-normal flex flex-wrap font-semibold"},Y={class:"flex-1"},Z={key:2},ee={key:0,class:"gap-normal micro:text-[1.5em] flex items-center text-[1.2em]"},oe=["title"],te=L({__name:"MainQuote",props:{quote:{},hasBecomeLink:{type:Boolean},hasNextLink:{type:Boolean}},emits:["next"],async setup(e,{emit:u}){let l,g;const m=u,y=e.quote.color??C(e.quote.name),b=(()=>{const o=e.quote.type==="cameo"?e.quote.messages:[...e.quote.messages??[],...j.config.project.sponsors?.defaultSponsorMessages],c=Math.floor(Math.random()*o.length);return o[c]})(),h=e.quote.type==="cameo"?Q(e.quote.avatarUrl):e.quote.avatarUrl?Q(e.quote.avatarUrl):"diamond";function q(){m("next"),setTimeout(()=>{d.value=R},400)}const d=I("arrow/left"),p=([l,g]=N(()=>E("add_quote","next_quote")),l=await l,g(),l);return(o,c)=>{const a=U,n=A,x=O,i=V;return r(),v("div",{style:$({"--color":t(y),"--colorBorder":"color-mix(in srgb, var(--color), var(--color-border) 70%)","--colorBg":"color-mix(in srgb, var(--color), var(--color-bg-main) 85%)","--colorText":"color-mix(in srgb, var(--color), var(--color-text) 85%)","--colorIcon":"color-mix(in srgb, var(--color), var(--color-text) 30%)"}),class:"micro:gap-[40px] flex gap-[30px]"},[s("div",F,[_(n,{external:"",target:"_blank",to:e.quote.link,class:"block rounded-full ring-2 ring-(--colorBorder)"},{default:w(()=>[_(a,{url:t(h),class:"border-bg-main micro:size-[60px] size-[40px] rounded-full border-2 [box-shadow:0_0_16px_0_var(--color)] transition-[border] [--mediaColor:var(--color)]"},null,8,["url"])]),_:1},8,["to"])]),s("div",H,[c[0]||(c[0]=s("div",{class:"micro:[--arrowSize:22px] absolute -top-[2px] -left-(--arrowSize) h-(--arrowSize) w-(--arrowSize) bg-(--colorBorder) transition-[background] [--arrowSize:14px] [--arrowSizeSmall:calc(var(--arrowSize)-2px)] [clip-path:polygon(110%_0,110%_110%,0_0)]"},[s("div",{class:"absolute top-[2px] -right-[3px] h-(--arrowSizeSmall) w-(--arrowSizeSmall) bg-(--colorBg) transition-[background] [clip-path:polygon(100%_0,100%_100%,0_0)]"})],-1)),s("div",W,[s("div",null,S(("formatText"in o?o.formatText:t(B))(t(b))),1),s("div",X,[s("div",Y,[e.quote.type==="cameo"||e.quote.avatarUrl?(r(),k(x,{key:0,class:"relative -top-[1.5px] mr-1.5 inline text-(--colorIcon)",name:e.quote.icon},null,8,["name"])):f("",!0),e.quote.link?(r(),k(n,{key:1,external:"",to:e.quote.link,target:"_blank",class:"text-hover-underline"},{default:w(()=>[P(S(("formatText"in o?o.formatText:t(B))(e.quote.name)),1)]),_:1},8,["to"])):(r(),v("span",Z,S(("formatText"in o?o.formatText:t(B))(e.quote.name)),1)),e.quote.link?(r(),k(i,{key:3,name:"arrow/outward",class:"relative -top-1 -right-1 inline text-(--colorText)/40"})):f("",!0)]),e.hasBecomeLink||e.hasNextLink?(r(),v("div",ee,[e.hasBecomeLink?(r(),k(n,{key:0,to:("PAGES"in o?o.PAGES:t(G)).sponsors,title:t(p).add_quote,class:"hocus:text-(--colorIcon) text-(--colorIcon)/40 transition-[color]"},{default:w(()=>[_(i,{name:"plus"})]),_:1},8,["to","title"])):f("",!0),e.hasNextLink?(r(),v("button",{key:1,onClick:q,title:t(p).next_quote,class:"hocus:text-(--colorIcon) cursor-pointer text-(--colorIcon)/40 transition-[color]"},[_(x,{name:t(d),class:"-scale-x-100"},null,8,["name"])],8,oe)):f("",!0)])):f("",!0)])])])],4)}}}),ae=Object.assign(te,{__name:"MainQuote"}),z="quote-ids",ne=L({__name:"MainQuoteLoader",async setup(e){let u,l;const g=K(),m=g.static.data[z]||=g.payload.data[z]||=([u,l]=N(()=>$fetch("/api/quote/ids",{responseType:"json"})),u=await u,l(),u),y=T(()=>Object.values(m).reduce((a,n)=>a+(n?.length??0),0)),b=T(()=>y.value>1),h=I();function q(){const a=[];for(const i in m){const M=m[i];M&&a.push(...M)}if(a.length===1)return a[0];const n=h.value?a.filter(i=>i!==h.value):a,x=Math.floor(Math.random()*n.length);return n[x]}const d=D(),p=I(0);let o=!1;async function c(){o=!0;const a=q();h.value=a;const n=await $fetch(`/api/quote/data/${a}`,{responseType:"json"});d.value=n,p.value++,o=!1}return J(()=>{Object.keys(m).length!==0&&c()}),(a,n)=>{const x=ae;return t(d)?(r(),v("section",{key:t(p),class:"px-main py-main-half"},[_(x,{quote:t(d),hasBecomeLink:!0,hasNextLink:t(b),onNext:n[0]||(n[0]=i=>!t(o)&&c())},null,8,["quote","hasNextLink"])])):f("",!0)}}}),le=Object.assign(ne,{__name:"MainQuoteLoader"});export{le as _};
