const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./katex.DmkBOJCM.css","./B8LSVuE2.js","./DPlMRrvx.js","./entry.BpQahQG6.css"])))=>i.map(i=>d[i]);
import{a as z,ah as F,h as _,U as r,a7 as G,o as K,V as Y,W as f,O as T,k as m,l as A,x as j,f as C,S as $,e as b,v as J,u as D,g as Q,s as X,_ as Z}from"./DPlMRrvx.js";import{u as ee}from"./BUhEJJRo.js";import{a as te}from"./TomfVRdr.js";import{_ as ae}from"./DG-eym6q.js";import{B as ne}from"./CW6fp5r3.js";/* empty css        */import"./CayKwvYF.js";import"./CjViLBBa.js";import"./B1Zwamhq.js";import"./BoGMoBBf.js";import"./C5qpKzH_.js";import"./kHqF3ywV.js";const ie=["innerHTML"],se={ref:"diagram"},oe={key:0,class:"p-normal text-center"},re=["innerHTML"],le=z({__name:"Diagram",props:{element:{}},setup(l){const H=F(),{EruditIcon:I,loadingSvg:R}=te(),u=r(!0),p=r(!1),h=r(""),P=_("dummy"),n=r(l.element.children[0].data),y=r(""),w=_("diagram"),x=_("diagramSvg"),V=G(),M=X(),{lightbox:k,initLightbox:W}=ee(),d={display:/\$\$(.*?)\$\$/gs,inline:new RegExp("\\$(?!\\$)(.*?)(?<!\\$)\\$","gs")};let o;K(async()=>{O(n.value)&&await U(),o=new IntersectionObserver(N,{root:null,threshold:.01}),o.observe(w.value)}),Y(()=>{o&&o.disconnect()});function B(){if(!k.value){const e=x.value.querySelector("svg"),t=e.cloneNode(!0);t.removeAttribute("width"),t.removeAttribute("style"),t.classList.add(H.diagram);let a=t;const i=w.value.closest("[data-prose-accent]");if(i){const s=document.createElement("div");s.setAttribute("data-prose-accent","");const L=getComputedStyle(i);for(const g of L)if(g.startsWith("--accent")){const S=L.getPropertyValue(g).trim();S&&s.style.setProperty(g,S)}s.appendChild(t),a=s}const c=Math.min(1e3,.9*window.innerWidth),v=e.clientHeight/e.clientWidth,E=`
            <div class="pswp__img-overlay-wrapper" style="position: relative">
                <div class="pswp__img" style="position: absolute; width: 100%; height: 100%; top: 0; left: 0;"></div>
                ${a.outerHTML}
            </div>
        `;W({dataSource:[{html:E,width:c,height:c*v}]},M.value)}k.value.loadAndOpen(0)}function O(e){return d.display.test(e)||d.inline.test(e)}async function U(){await f(()=>Promise.resolve({}),__vite__mapDeps([0]),import.meta.url);const e=await f(()=>import("./DhXJpUyf.js"),[],import.meta.url),t="__ERUDIT_DIAGRAM_MATH_DUMMY__";window[t]||(h.value=e.renderToString("\\sum_{i=1}^n i^2 = \\frac{n(n+1)(2n+1)}{6}",{displayMode:!0}),window[t]=!0);const a=(i,c,v)=>i.replace(c,(E,s)=>e.renderToString(s,{displayMode:v}));n.value=a(n.value,d.display,!0),n.value=a(n.value,d.inline,!1),await T(),await new Promise(requestAnimationFrame)}async function N(e){if(!e.some(a=>a.isIntersecting)||!u.value||p.value)return;p.value=!0,await q(),p.value=!1,u.value=!1,o.disconnect(),await T();const t=x.value?.querySelector("svg");t&&t.addEventListener("click",B)}async function q(){const e=(await f(async()=>{const{default:a}=await import("./B8LSVuE2.js").then(i=>i.bB);return{default:a}},__vite__mapDeps([1,2,3]),import.meta.url)).default;e.initialize({startOnLoad:!1,securityLevel:"loose",markdownAutoWrap:!1,flowchart:{useMaxWidth:!0,padding:10,wrappingWidth:400},theme:"base"});const{svg:t}=await e.render(V,n.value,P.value);y.value=t}return(e,t)=>(m(),A(ne,{element:l.element},{default:j(()=>[C("div",{ref:"dummy",class:$([e.$style.diagram,"fixed -top-[9999px] -left-[9999px]"]),innerHTML:h.value},null,10,ie),C("div",se,[u.value?(m(),b("div",oe,[J(D(I),{name:D(R),class:"text-text-dimmed inline text-[60px]"},null,8,["name"])])):(m(),b("div",{key:1,ref:"diagramSvg",innerHTML:y.value,class:$(e.$style.diagram)},null,10,re))],512),l.element.children[1]?(m(),A(ae,{key:0,caption:l.element.children[1],onCaptionMounted:t[0]||(t[0]=a=>M.value=a)},null,8,["caption"])):Q("",!0)]),_:1},8,["element"]))}}),de="_diagram_192y5_3",ce="_katex_192y5_15",me={diagram:de,katex:ce},ue={$style:me},Le=Z(le,[["__cssModules",ue]]);export{Le as default};
