import{s as E,_ as L}from"./B37EUJiU.js";import{a as N,ak as j,E as U,G as B,n as C,C as $,k as s,e as _,R as A,u as t,f as r,v as y,Q as J,x as I,t as S,J as M,l as k,g as x,y as R,K as P,P as V,I as D,U as T,B as G,o as O,c as Q,s as K}from"./DPlMRrvx.js";const F={class:"shrink-0"},H={class:"p-small micro:p-normal relative flex-1 rounded rounded-tl-none border-2 border-(--colorBorder) bg-(--colorBg)"},W={class:"gap-small flex flex-col font-serif text-(--colorText)"},X={class:"text-main-sm gap-normal flex flex-wrap font-semibold"},Y={class:"flex-1"},Z={key:2},ee={key:0,class:"gap-normal micro:text-[1.5em] flex items-center text-[1.2em]"},oe=["title"],te=N({__name:"MainQuote",props:{quote:{},canJoin:{type:Boolean},hasNextLink:{type:Boolean}},emits:["next"],async setup(e,{emit:u}){let l,f;const m=u,q=j(),b=e.quote.color??E(e.quote.name),g=(()=>{const a=e.quote.type==="cameo"?e.quote.messages:[...e.quote.messages??[],...U.config.project.sponsors?.defaultSponsorMessages],o=Math.floor(Math.random()*a.length);return a[o]})(),w=e.quote.type==="cameo"?B(e.quote.avatarUrl):e.quote.avatarUrl?B(e.quote.avatarUrl):"diamond";function p(){m("next"),setTimeout(()=>{v.value=q},400)}const v=T("arrow/left"),d=([l,f]=C(()=>$("add_quote","next_quote")),l=await l,f(),l);return(a,o)=>{const n=L,c=J,i=D,h=P;return s(),_("div",{style:A({"--color":t(b),"--colorBorder":"color-mix(in srgb, var(--color), var(--color-border) 70%)","--colorBg":"color-mix(in srgb, var(--color), var(--color-bg-main) 85%)","--colorText":"color-mix(in srgb, var(--color), var(--color-text) 85%)","--colorIcon":"color-mix(in srgb, var(--color), var(--color-text) 30%)"}),class:"micro:gap-[40px] flex gap-[30px]"},[r("div",F,[y(c,{external:"",target:"_blank",to:e.quote.link,class:"block rounded-full ring-2 ring-(--colorBorder)"},{default:I(()=>[y(n,{url:t(w),class:"border-bg-main micro:size-[60px] size-[40px] rounded-full border-2 [box-shadow:0_0_16px_0_var(--color)] [--mediaColor:var(--color)]"},null,8,["url"])]),_:1},8,["to"])]),r("div",H,[o[0]||(o[0]=r("div",{class:"micro:[--arrowSize:22px] absolute -top-[2px] -left-(--arrowSize) h-(--arrowSize) w-(--arrowSize) bg-(--colorBorder) [--arrowSize:14px] [--arrowSizeSmall:calc(var(--arrowSize)-2px)] [clip-path:polygon(110%_0,110%_110%,0_0)]"},[r("div",{class:"absolute top-[2px] -right-[3px] h-(--arrowSizeSmall) w-(--arrowSizeSmall) bg-(--colorBg) [clip-path:polygon(100%_0,100%_100%,0_0)]"})],-1)),r("div",W,[r("div",null,S(("formatText"in a?a.formatText:t(M))(t(g))),1),r("div",X,[r("div",Y,[e.quote.type==="cameo"||e.quote.avatarUrl?(s(),k(i,{key:0,class:"relative -top-[1.5px] mr-1.5 inline text-(--colorIcon)",name:e.quote.icon},null,8,["name"])):x("",!0),e.quote.link?(s(),k(c,{key:1,external:"",to:e.quote.link,target:"_blank",class:"text-hover-underline"},{default:I(()=>[R(S(("formatText"in a?a.formatText:t(M))(e.quote.name)),1)]),_:1},8,["to"])):(s(),_("span",Z,S(("formatText"in a?a.formatText:t(M))(e.quote.name)),1)),e.quote.link?(s(),k(h,{key:3,name:"arrow/outward",class:"relative -top-1 -right-1 inline text-(--colorText)/40"})):x("",!0)]),e.canJoin||e.hasNextLink?(s(),_("div",ee,[e.canJoin?(s(),k(c,{key:0,to:("PAGES"in a?a.PAGES:t(V)).sponsors,title:t(d).add_quote,class:"hocus:text-(--colorIcon) text-(--colorIcon)/40 transition-[color]"},{default:I(()=>[y(h,{name:"plus"})]),_:1},8,["to","title"])):x("",!0),e.hasNextLink?(s(),_("button",{key:1,onClick:p,title:t(d).next_quote,class:"hocus:text-(--colorIcon) cursor-pointer text-(--colorIcon)/40 transition-[color]"},[y(i,{name:t(v),class:"-scale-x-100"},null,8,["name"])],8,oe)):x("",!0)])):x("",!0)])])])],4)}}}),ae=Object.assign(te,{__name:"MainQuote"}),z="quote-ids",ne=N({__name:"MainQuoteLoader",async setup(e){let u,l;const f=G(),m=f.static.data[z]||=f.payload.data[z]||=([u,l]=C(()=>$fetch("/api/quote/ids",{responseType:"json"})),u=await u,l(),u),q=Q(()=>Object.values(m).reduce((o,n)=>o+(n?.length??0),0)),b=Q(()=>q.value>1),g=T();function w(){const o=[];for(const i in m){const h=m[i];h&&o.push(...h)}if(o.length===1)return o[0];const n=g.value?o.filter(i=>i!==g.value):o,c=Math.floor(Math.random()*n.length);return n[c]}const p=K(),v=T(0);let d=!1;async function a(){d=!0;const o=w();g.value=o;const n=await $fetch(`/api/quote/data/${o}`,{responseType:"json"});p.value=n,v.value++,d=!1}return O(()=>{Object.keys(m).length!==0&&a()}),(o,n)=>{const c=ae;return t(p)?(s(),_("section",{key:t(v),class:"px-main py-main-half"},[y(c,{quote:t(p),canJoin:("ERUDIT"in o?o.ERUDIT:t(U)).config.project.sponsors?.enabled,hasNextLink:t(b),onNext:n[0]||(n[0]=i=>!t(d)&&a())},null,8,["quote","canJoin","hasNextLink"])])):x("",!0)}}}),le=Object.assign(ne,{__name:"MainQuoteLoader"});export{le as _};
