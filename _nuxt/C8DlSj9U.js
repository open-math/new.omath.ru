const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./katex.DmkBOJCM.css"])))=>i.map(i=>d[i]);
import{X as B,bg as N,Z as s,au as S,bh as U,$ as z,aH as F,aV as f,aq as W,O as m,a1 as A,U as K,R as Q,Q as L,T as X,ac as _,ad as Z,a5 as j,at as G,_ as J}from"./C4wjQouH.js";import{u as Y}from"./CaCtDKSH.js";import{u as ee}from"./Cgwm3dOG.js";import{_ as te}from"./CMSQqeAO.js";import{B as ae}from"./BbiXdM8k.js";/* empty css        */import"./ncnv4UyD.js";import"./-6Xo9kHI.js";import"./CkE9ToxK.js";import"./BokzypnP.js";import"./Bcq7iQgg.js";import"./CewF_czH.js";import"./D5fLQY3u.js";const ne={ref:"diagram"},ie={key:0,class:"p-normal text-center"},se=["innerHTML"],oe=B({__name:"Diagram",props:{element:{}},setup(o){let h=s();const M=N(),{EruditIcon:P,loadingSvg:T}=ee(),u=s(!0),p=s(!1),n=s(o.element.children[0].data),y=s(""),w=S("diagram"),b=S("diagramSvg"),R=U(),x=G(),{lightbox:k,initLightbox:I}=Y(),r={display:/\$\$(.*?)\$\$/gs,inline:new RegExp("\\$(?!\\$)(.*?)(?<!\\$)\\$","gs")};let i;z(async()=>{const e=navigator.userAgent;h.value=/AppleWebKit/.test(e)&&!/Chrome/.test(e)||/\b(iPad|iPhone|iPod)\b/.test(e),D(n.value)&&await H(),i=new IntersectionObserver(O,{root:null,threshold:.01}),i.observe(w.value)}),F(()=>{i&&i.disconnect()});function V(){if(!k.value){const e=b.value.querySelector("svg"),t=e.cloneNode(!0);t.removeAttribute("width"),t.removeAttribute("style"),t.classList.add(M.diagram);let a=t;const l=w.value.closest("[data-prose-accent]");if(l){const d=document.createElement("div");d.setAttribute("data-prose-accent","");const $=getComputedStyle(l);for(const g of $)if(g.startsWith("--accent")){const C=$.getPropertyValue(g).trim();C&&d.style.setProperty(g,C)}d.appendChild(t),a=d}const c=Math.min(1e3,.9*window.innerWidth),E=e.clientHeight/e.clientWidth,v=`
            <div class="pswp__img-overlay-wrapper" style="position: relative">
                <div class="pswp__img" style="position: absolute; width: 100%; height: 100%; top: 0; left: 0;"></div>
                ${a.outerHTML}
            </div>
        `;I({dataSource:[{html:v,width:c,height:c*E}]},x.value)}k.value.loadAndOpen(0)}function D(e){return r.display.test(e)||r.inline.test(e)}async function H(){await f(()=>Promise.resolve({}),__vite__mapDeps([0]),import.meta.url);const e=await f(()=>import("./DhXJpUyf.js"),[],import.meta.url),t=(a,l,c)=>a.replace(l,(E,v)=>e.renderToString(v,{displayMode:c,output:"mathml"}).replace(/<mtd>/g,'<mtd style="padding: 0.2em 0;">').replace(/<annotation encoding="application\/x-tex">[\s\S]*?<\/annotation>/g,""));n.value=t(n.value,r.display,!0),n.value=t(n.value,r.inline,!1),await W(),await new Promise(requestAnimationFrame)}async function O(e){if(!e.some(a=>a.isIntersecting)||!u.value||p.value)return;p.value=!0,await q(),p.value=!1,u.value=!1,i.disconnect(),await W();const t=b.value?.querySelector("svg");t&&t.addEventListener("click",V)}async function q(){const e=(await f(async()=>{const{default:a}=await import("https://cdn.jsdelivr.net/npm/mermaid@11.12.2/+esm");return{default:a}},[],import.meta.url)).default;e.initialize({startOnLoad:!1,securityLevel:"loose",markdownAutoWrap:!1,flowchart:{useMaxWidth:!0,padding:10,wrappingWidth:400},theme:"base"});const{svg:t}=await e.render(R,n.value);y.value=t}return(e,t)=>(m(),A(ae,{element:o.element},{default:K(()=>[Q("div",ne,[u.value?(m(),L("div",ie,[X(_(P),{name:_(T),class:"text-text-dimmed inline text-[60px]"},null,8,["name"])])):(m(),L("div",{key:1,ref:"diagramSvg",innerHTML:y.value,class:Z([_(h)?"":e.$style.notWebkit,e.$style.diagram])},null,10,se))],512),o.element.children[1]?(m(),A(te,{key:0,caption:o.element.children[1],onCaptionMounted:t[0]||(t[0]=a=>x.value=a)},null,8,["caption"])):j("",!0)]),_:1},8,["element"]))}}),re="_notWebkit_5vnqs_5",le="_diagram_5vnqs_5",ce={notWebkit:re,diagram:le},de={$style:ce},Ee=J(oe,[["__cssModules",de]]);export{Ee as default};
