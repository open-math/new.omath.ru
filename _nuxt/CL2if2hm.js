import{s as C,_ as U}from"./CZU75N3T.js";import{Q as z,ab as $,Z as Q,R as I,a2 as N,a5 as j,H as v,I as r,Y as A,a6 as t,J as s,L as _,$ as E,M as w,K as S,a8 as M,V as f,U as k,N as V,ad as O,a9 as P,ac as R,al as G,a1 as K,a4 as T,am as D,S as H}from"./D2eihLR_.js";const J={class:"shrink-0"},Y={class:"p-small micro:p-normal relative flex-1 rounded rounded-tl-none border-2 border-(--colorBorder) bg-(--colorBg) transition-[background,border]"},Z={class:"gap-small flex flex-col font-serif text-(--colorText)"},F={class:"text-main-sm gap-normal flex flex-wrap font-semibold"},W={class:"flex-1"},X={key:2},ee={key:0,class:"gap-normal micro:text-[1.5em] flex items-center text-[1.2em]"},oe=["title"],te=z({__name:"MainQuote",props:{quote:{},hasBecomeLink:{type:Boolean},hasNextLink:{type:Boolean}},emits:["next"],async setup(e,{emit:u}){let l,g;const m=u,y=e.quote.color??C(e.quote.name),b=(()=>{const o=e.quote.type==="cameo"?e.quote.messages:e.quote.messages??$.config.project.sponsors?.defaultSponsorMessages,c=Math.floor(Math.random()*o.length);return o[c]})(),h=e.quote.type==="cameo"?Q(e.quote.avatarUrl):e.quote.avatarUrl?Q(e.quote.avatarUrl):"diamond";function q(){m("next"),setTimeout(()=>{d.value=G},400)}const d=I("arrow/left"),p=([l,g]=N(()=>j("add_quote","next_quote")),l=await l,g(),l);return(o,c)=>{const a=U,n=E,x=R,i=O;return r(),v("div",{style:A({"--color":t(y),"--colorBorder":"color-mix(in srgb, var(--color), var(--color-border) 70%)","--colorBg":"color-mix(in srgb, var(--color), var(--color-bg-main) 85%)","--colorText":"color-mix(in srgb, var(--color), var(--color-text) 85%)","--colorIcon":"color-mix(in srgb, var(--color), var(--color-text) 30%)"}),class:"micro:gap-[40px] flex gap-[30px]"},[s("div",J,[_(n,{external:"",target:"_blank",to:e.quote.link,class:"block rounded-full ring-2 ring-(--colorBorder)"},{default:w(()=>[_(a,{url:t(h),class:"border-bg-main micro:size-[60px] size-[40px] rounded-full border-2 [box-shadow:0_0_16px_0_var(--color)] transition-[border] [--mediaColor:var(--color)]"},null,8,["url"])]),_:1},8,["to"])]),s("div",Y,[c[0]||(c[0]=s("div",{class:"micro:[--arrowSize:22px] absolute -top-[2px] -left-(--arrowSize) h-(--arrowSize) w-(--arrowSize) bg-(--colorBorder) transition-[background] [--arrowSize:14px] [--arrowSizeSmall:calc(var(--arrowSize)-2px)] [clip-path:polygon(110%_0,110%_110%,0_0)]"},[s("div",{class:"absolute top-[2px] -right-[3px] h-(--arrowSizeSmall) w-(--arrowSizeSmall) bg-(--colorBg) transition-[background] [clip-path:polygon(100%_0,100%_100%,0_0)]"})],-1)),s("div",Z,[s("div",null,S(("formatText"in o?o.formatText:t(M))(t(b))),1),s("div",F,[s("div",W,[e.quote.type==="cameo"||e.quote.avatarUrl?(r(),k(x,{key:0,class:"relative -top-[1.5px] mr-1.5 inline text-(--colorIcon)",name:e.quote.icon},null,8,["name"])):f("",!0),e.quote.link?(r(),k(n,{key:1,external:"",to:e.quote.link,target:"_blank",class:"text-hover-underline"},{default:w(()=>[V(S(("formatText"in o?o.formatText:t(M))(e.quote.name)),1)]),_:1},8,["to"])):(r(),v("span",X,S(("formatText"in o?o.formatText:t(M))(e.quote.name)),1)),e.quote.link?(r(),k(i,{key:3,name:"arrow/outward",class:"relative -top-1 -right-1 inline text-(--colorText)/40"})):f("",!0)]),e.hasBecomeLink||e.hasNextLink?(r(),v("div",ee,[e.hasBecomeLink?(r(),k(n,{key:0,to:("PAGES"in o?o.PAGES:t(P)).sponsors,title:t(p).add_quote,class:"hocus:text-(--colorIcon) text-(--colorIcon)/40 transition-[color]"},{default:w(()=>[_(i,{name:"plus"})]),_:1},8,["to","title"])):f("",!0),e.hasNextLink?(r(),v("button",{key:1,onClick:q,title:t(p).next_quote,class:"hocus:text-(--colorIcon) cursor-pointer text-(--colorIcon)/40 transition-[color]"},[_(x,{name:t(d),class:"-scale-x-100"},null,8,["name"])],8,oe)):f("",!0)])):f("",!0)])])])],4)}}}),ae=Object.assign(te,{__name:"MainQuote"}),L="quote-ids",ne=z({__name:"MainQuoteLoader",async setup(e){let u,l;const g=K(),m=g.static.data[L]||=g.payload.data[L]||=([u,l]=N(()=>$fetch("/api/quote/ids",{responseType:"json"})),u=await u,l(),u),y=T(()=>Object.values(m).reduce((a,n)=>a+(n?.length??0),0)),b=T(()=>y.value>1),h=I();function q(){const a=[];for(const i in m){const B=m[i];B&&a.push(...B)}if(a.length===1)return a[0];const n=h.value?a.filter(i=>i!==h.value):a,x=Math.floor(Math.random()*n.length);return n[x]}const d=D(),p=I(0);let o=!1;async function c(){o=!0;const a=q();h.value=a;const n=await $fetch(`/api/quote/data/${a}`,{responseType:"json"});d.value=n,p.value++,o=!1}return H(()=>{Object.keys(m).length!==0&&c()}),(a,n)=>{const x=ae;return t(d)?(r(),v("section",{key:t(p),class:"px-main py-main-half"},[_(x,{quote:t(d),hasBecomeLink:!0,hasNextLink:t(b),onNext:n[0]||(n[0]=i=>!t(o)&&c())},null,8,["quote","hasNextLink"])])):f("",!0)}}}),le=Object.assign(ne,{__name:"MainQuoteLoader"});export{le as _};
