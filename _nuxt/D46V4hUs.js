import{_ as U,a as F,b as V}from"./BTN9jeFN.js";import{_ as L,a as R}from"./Cf7KL_jA.js";import{s as w,_ as W}from"./Dy0ynRZs.js";import{W as T,X as N,Y as D,Z as J,$ as K,N as n,a0 as _,S as B,P as k,Q as I,O as u,a1 as S,a2 as z,a3 as E,a4 as a,a5 as Q,a6 as X,a7 as Y,a8 as M,a9 as Z,aa as q,ab as H,R as P,ac as e,ad as tt,ae as A,af as C,ag as et}from"./DN7F3Kmz.js";import{_ as nt}from"./BIIdZ_dd.js";import"./Be5BNeiQ.js";import"./BRlCJR6e.js";import"./BokzypnP.js";import"./CZswOW18.js";const ot={class:"group-hocus:text-brand text-text-muted text-main-lg font-semibold transition-[color]"},st={class:"flex gap-1.5"},rt={key:0,class:"group-hocus:text-brand group-hocus:border-brand border-text-dimmed text-text-muted grid size-(--avatarSize) place-items-center rounded-full border-3 border-dashed text-[17px] leading-none font-semibold transition-[color,border]"},at=2500,it=T({__name:"IndexPagePersons",props:{personType:{},title:{},link:{},persons:{}},setup(l){const o=N(),c=Object.keys(l.persons),h=c.length,x=Math.min(4,h),g=h-x,t=D(Array.from({length:x},(m,i)=>({personId:`dummy-${i}`,url:void 0,color:void 0})));let y;function b(m,i){return i===0?l.personType==="contributor"?"user":"diamond":o(`/file/${l.personType}s/${m}/avatar.${i}`)}function s(m){return m[Math.floor(Math.random()*m.length)]}return J(()=>{const i=[...c].sort(()=>Math.random()-.5).slice(0,x);t.value=i.map(r=>({personId:r,url:b(r,l.persons[r]),color:w(r)})),!(h<=x)&&(y=window.setInterval(()=>{const r=t.value.map(v=>v.personId),f=c.filter(v=>!r.includes(v));if(!f.length)return;const d=Math.floor(Math.random()*t.value.length),p=s(f);t.value[d]={personId:p,url:b(p,l.persons[p]),color:w(p)}},at))}),K(()=>{y&&clearInterval(y)}),(m,i)=>{const r=W,f=Q;return n(),_(f,{to:l.link,class:"group gap-normal flex flex-col items-center [--avatarSize:50px]"},{default:B(()=>[k("div",ot,I(l.title),1),k("div",st,[(n(!0),u(S,null,z(t.value,d=>(n(),_(r,{key:d.personId,url:d.url,style:E({"--mediaColor":d.color}),class:"size-(--avatarSize) rounded-full"},null,8,["url","style"]))),128)),g?(n(),u("div",rt,I("+"+g),1)):a("",!0)])]),_:1},8,["to"])}}}),lt=Object.assign(it,{__name:"IndexPagePersons"}),ct=["src"],mt={class:"px-main gap-normal py-main flex flex-col items-center text-center"},ut={class:"micro:text-[1.3em] text-text-muted text-[1.1em] font-semibold"},dt={key:0,class:"gap-small micro:gap-normal micro:text-[1.2em] flex flex-wrap justify-center text-[1.1em]"},pt={key:1,class:"micro:text-justify px-main pb-main text-center"},_t={key:2,class:"px-main pb-main gap-main flex flex-wrap justify-around"},$="index-page",Pt=T({__name:"index",async setup(l){let o,c;const{showNewsAside:h}=X();h();const x=N(),g=Y(),t=g.static.data[$]||=g.payload.data[$]||=([o,c]=M(()=>Z("/api/indexPage")),o=await o,c(),o);q(t);const y=et(()=>t.topImage?.invert?t.topImage.invert==="dark"?"dark:hue-rotate-180 dark:invert-100":t.topImage.invert==="light"?"hue-rotate-180 invert-100 dark:hue-rotate-0 dark:invert-0":"":""),b=([o,c]=M(()=>H("x_contributors","x_sponsors")),o=await o,c(),o);return(s,m)=>{const i=U,r=F,f=L,d=R,p=lt,v=V,j=nt;return n(),u(S,null,[P(i),P(v,null,{default:B(()=>[e(t).topImage?(n(),u("img",{key:0,src:e(x)(e(t).topImage.src),style:E({"max-width":`min(${e(t).topImage.maxWidth||"100%"}, 100%)`}),class:tt(["pt-main-half px-main mx-auto block",e(y)])},null,14,ct)):a("",!0),k("div",mt,[k("h1",null,[P(r,{text:e(t).title,class:"text-size-h1"},null,8,["text"])]),k("div",ut,I(("formatText"in s?s.formatText:e(A))(e(t).short)),1),e(t).stats?(n(),u("div",dt,[e(t).stats.materials?(n(),_(f,{key:0,count:e(t).stats.materials,mode:"compact"},null,8,["count"])):a("",!0),e(t).stats.elements?(n(!0),u(S,{key:1},z(e(t).stats.elements,(G,O)=>(n(),_(d,{schemaName:O,count:G,mode:"compact"},null,8,["schemaName","count"]))),256)):a("",!0)])):a("",!0)]),e(t).description?(n(),u("div",pt,I(("formatText"in s?s.formatText:e(A))(e(t).description)),1)):a("",!0),e(t).contributors||e(t).sponsors?(n(),u("div",_t,[e(t).contributors?(n(),_(p,{key:0,personType:"contributor",title:e(b).x_contributors(Object.keys(e(t).contributors).length),link:("PAGES"in s?s.PAGES:e(C)).contributors,persons:e(t).contributors},null,8,["title","link","persons"])):a("",!0),e(t).sponsors?(n(),_(p,{key:1,personType:"sponsor",title:e(b).x_sponsors(Object.keys(e(t).sponsors).length),link:("PAGES"in s?s.PAGES:e(C)).sponsors,persons:e(t).sponsors},null,8,["title","link","persons"])):a("",!0)])):a("",!0)]),_:1}),e(t).children?(n(),_(j,{key:0,children:e(t).children},null,8,["children"])):a("",!0)],64)}}});export{Pt as default};
