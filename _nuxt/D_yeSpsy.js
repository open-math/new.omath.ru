import{aD as _e,bg as ke,bh as Ce,_ as ye,e as i,k as t,f as w,p as ie,a as Z,U as k,a0 as de,F as S,l as h,t as T,h as a,v as I,S as R,a1 as J,x as y,g as $,r as A,n as H,b as _,bi as ne,u as Q,w as Ee,Z as me,bj as ve,bk as pe,s as z,c as L,bl as Me,bm as Se,bn as ae,aK as le,aL as re,aM as oe,o as $e,R as ce,Y as Ae}from"./Co3pHHec.js";import{u as Ie,a as Re}from"./Cbjy90RY.js";import{a as V}from"./BQwS8Ze9.js";import{a as Ze,b as Be}from"./DPRGGL4g.js";import{u as Pe}from"./6C2aBVuG.js";import{D as W}from"./CKnKVxRx.js";import{p as X}from"./y9Kl881g.js";import{_ as j}from"./C3H9pxtj.js";import{u as he}from"./C2dLlXeG.js";import{s as Fe}from"./kHqF3ywV.js";/* empty css        */async function Ne(e){const{rawElement:s,pre:c,post:n,step:l,ids:o}=e,d=new Set(o),u={};async function f(b){let C;if(b.children){C=[];for(const M of b.children){const x=await f(M);C.push(x)}}c&&await c(b);const E=_e.getSchema(b.schemaName),m={...ke("prose",E),data:b.data,storageKey:b.storageKey,children:C};return b.uniqueName&&(m.uniqueName=b.uniqueName,u[b.uniqueName]=m),n&&await n(m),l&&await l({rawElement:b,proseElement:m}),m}return{proseElement:await f(s),uniques:u,ids:d}}async function K(){const{appElements:e,languageCode:s}=V();return await e[Ce.name].languages[s]()}const Te=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20">
  <path d="M8.86,13.75l5.75-5.75-1.14-1.14-4.61,4.61-2.32-2.32-1.14,1.14,3.47,3.47ZM10,18.15c-1.13,0-2.19-.21-3.18-.64-.99-.43-1.86-1.01-2.59-1.74-.73-.73-1.31-1.6-1.74-2.59-.43-.99-.64-2.05-.64-3.18,0-1.13.21-2.19.64-3.18s1.01-1.86,1.74-2.59c.73-.73,1.6-1.31,2.59-1.74s2.05-.64,3.18-.64c1.13,0,2.19.21,3.18.64.99.43,1.86,1.01,2.59,1.74.73.73,1.31,1.6,1.74,2.59.43.99.64,2.05.64,3.18s-.22,2.19-.64,3.18c-.43.99-1.01,1.86-1.74,2.59s-1.6,1.31-2.59,1.74c-.99.43-2.05.64-3.18.64M10,16.52c1.82,0,3.36-.63,4.63-1.9s1.9-2.81,1.9-4.63-.63-3.36-1.9-4.63c-1.26-1.26-2.81-1.9-4.63-1.9-1.82,0-3.36.63-4.63,1.9s-1.9,2.81-1.9,4.63c0,1.82.63,3.36,1.9,4.63,1.26,1.26,2.81,1.9,4.63,1.9"/>
</svg>`,fe=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32">
  <path d="M28.58,6.4l-7.8,20.14c-.26.67-1.01,1-1.68.74-.16-.06-.3-.15-.43-.27l-4.39-4.21-2.7,2.7c-.26.26-.66.26-.92,0-.12-.12-.19-.29-.19-.46v-5.87l-6.74-6.46c-.52-.5-.54-1.32-.04-1.84.17-.18.38-.3.62-.36l22.74-5.84c.7-.18,1.4.24,1.58.94.06.26.05.54-.05.79h0ZM25.42,7.88l-14.25,9.29,2.26,2.16,12-11.45h0Z"/>
</svg>`,De=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16">
  <path d="M2,2v1.5h2.1l-.37.3c-.6.6-1.02,1.25-1.27,1.95-.3.7-.45,1.42-.45,2.17,0,1.4.42,2.65,1.27,3.75.8,1.05,1.87,1.77,3.22,2.17v-1.57c-.9-.35-1.62-.92-2.17-1.72-.55-.75-.82-1.62-.82-2.62,0-.55.1-1.07.3-1.57.2-.55.55-1.05,1.05-1.5l.15-.15v1.8h1.5V2H2ZM9.5,2.23v1.57c.9.3,1.62.85,2.17,1.65.55.75.82,1.62.82,2.62,0,.55-.1,1.07-.3,1.57-.25.55-.57,1.05-.97,1.5l-.22.15v-1.8h-1.5v4.5h4.5v-1.5h-2.02l.22-.22c.65-.65,1.1-1.32,1.35-2.02.3-.75.45-1.47.45-2.17,0-1.4-.42-2.65-1.27-3.75-.8-1.1-1.87-1.82-3.22-2.17v.07Z"/>
</svg>`,We=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 22 22">
  <path d="M11,6.36c2.56,0,4.64,2.08,4.64,4.64,0,1.72-.93,3.21-2.32,4.02v1.39c0,.43-.35.77-.77.77h-3.09c-.43,0-.77-.35-.77-.77v-1.39c-1.38-.8-2.32-2.3-2.32-4.02,0-2.56,2.08-4.64,4.64-4.64M12.55,17.95v.77c0,.43-.35.77-.77.77h-1.55c-.43,0-.77-.35-.77-.77v-.77h3.09ZM17.18,10.23h2.32v1.55h-2.32v-1.55ZM2.5,10.23h2.32v1.55h-2.32v-1.55ZM11.77,2.5v2.32h-1.55v-2.32h1.55ZM5.53,4.43l1.65,1.65-1.1,1.09-1.65-1.64,1.1-1.1ZM14.83,6.08l1.64-1.65,1.11,1.1-1.65,1.64-1.1-1.1Z"/>
</svg>`,He=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16.97 16.97">
  <path d="M10.41,4.64c0-.31.2-.57.43-.79.21-.2.34-.45.34-.72,0-.63-.69-1.15-1.53-1.15s-1.53.51-1.53,1.15c0,.28.13.53.35.73.22.2.42.46.42.76,0,.41-.33.74-.74.75-.02,0-.03,0-.05,0-.77-.05-1.54-.13-2.31-.23-.31-.04-.6.17-.65.49,0,.05,0,.11,0,.16.11.76.19,1.53.23,2.31.02.41-.29.76-.7.78-.02,0-.03,0-.05,0-.3,0-.56-.19-.76-.42-.2-.22-.45-.35-.73-.35-.63,0-1.15.69-1.15,1.53s.51,1.53,1.15,1.53c.27,0,.52-.13.72-.34.21-.23.48-.43.79-.43.42,0,.77.34.77.76,0,.01,0,.02,0,.03-.04.96-.12,1.91-.24,2.86-.04.31.18.6.49.64.8.11,1.62.19,2.44.24.41.02.76-.29.78-.7,0-.02,0-.03,0-.05,0-.3-.19-.56-.42-.76-.22-.2-.35-.45-.35-.73,0-.63.69-1.15,1.53-1.15s1.53.51,1.53,1.15c0,.27-.13.52-.34.72-.23.21-.43.48-.43.79,0,.42.34.77.76.77,0,0,.02,0,.03,0,1.02-.04,2.04-.12,3.03-.26.26-.03.46-.24.49-.49.13-1,.22-2.01.26-3.03.01-.42-.32-.78-.74-.79,0,0-.02,0-.03,0-.31,0-.57.2-.79.43-.2.21-.45.34-.72.34-.63,0-1.15-.69-1.15-1.53s.51-1.53,1.15-1.53c.28,0,.53.13.73.35.2.22.46.42.76.42.41,0,.75-.33.75-.74,0-.02,0-.03,0-.05-.05-.82-.13-1.63-.24-2.44-.04-.31-.33-.53-.64-.49-.94.13-1.89.21-2.86.24-.42.01-.77-.32-.79-.74,0-.01,0-.02,0-.03"/>
</svg>`,Ve=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 560">
  <path d="M119.1,480c-8.15,0-14.95-2.75-20.41-8.26-5.51-5.45-8.26-12.25-8.26-20.41s2.75-14.9,8.26-20.41c5.45-5.45,12.25-8.18,20.41-8.18h229.09c8.15,0,14.95,2.73,20.41,8.18s8.26,12.31,8.26,20.41c0,8.15-2.75,14.95-8.26,20.41-5.45,5.51-12.25,8.26-20.41,8.26H119.1ZM119.1,365.42c-8.1,0-14.9-2.75-20.41-8.26-5.45-5.45-8.18-12.25-8.18-20.41s2.73-14.9,8.18-20.41c5.51-5.45,12.31-8.18,20.41-8.18h401c8.15,0,14.95,2.73,20.41,8.18,5.51,5.51,8.26,12.31,8.26,20.41s-2.75,14.95-8.26,20.41c-5.45,5.51-12.25,8.26-20.41,8.26H119.1ZM119.1,250.83c-8.1,0-14.9-2.73-20.41-8.18-5.45-5.51-8.18-12.31-8.18-20.41s2.73-14.95,8.18-20.41c5.51-5.51,12.31-8.26,20.41-8.26h401c8.15,0,14.95,2.75,20.41,8.26,5.51,5.45,8.26,12.25,8.26,20.41s-2.75,14.9-8.26,20.41c-5.45,5.45-12.25,8.18-20.41,8.18H119.1ZM119.1,136.25c-8.1,0-14.9-2.73-20.41-8.18-5.45-5.51-8.18-12.31-8.18-20.41s2.73-14.95,8.18-20.41c5.51-5.51,12.31-8.26,20.41-8.26h401c8.15,0,14.95,2.75,20.41,8.26,5.51,5.45,8.26,12.25,8.26,20.41s-2.75,14.9-8.26,20.41c-5.45,5.45-12.25,8.18-20.41,8.18H119.1Z"/>
</svg>`;async function je(e,s){if(!e||!s)return;const n=(await import(e)).default;return n(s)}const qe={},Ge={class:"border-border border-t transition-[border]"};function Oe(e,s){return t(),i("div",null,[w("div",Ge,[ie(e.$slots,"default")])])}const ee=ye(qe,[["render",Oe]]),Ue={class:"flex-1"},ze={class:"group-hocus:bg-border/80 text-text-muted shrink-0 rounded bg-transparent p-0.5 transition-[background]"},Le={key:0,class:"border-border border-t border-dashed py-(--proseAsideWidth) transition-[border]"},be=Z({__name:"ProblemExpanderSection",props:{title:{},element:{}},setup(e){const s=he(),{EruditIcon:c}=V(),n=k(!1),l=Ze(e.element);return de(()=>{l.value&&(n.value=!0)}),(o,d)=>(t(),i(S,null,[w("div",{onClick:d[0]||(d[0]=u=>n.value=!n.value),class:"group border-border text-text-muted relative flex cursor-pointer items-center border-t p-(--proseAsideWidth) font-semibold transition-[border] first:border-t-0"},[w("div",Ue,T(a(s)(e.title)),1),w("button",ze,[I(a(c),{name:a(X),class:R(["micro:text-[26px] text-[22px] transition-[rotate]",n.value?"rotate-45":""])},null,8,["name","class"])])]),(t(),h(J,null,{default:y(()=>[n.value?(t(),i("div",Le,[(t(!0),i(S,null,A(e.element.children,u=>(t(),h(j,{element:u},null,8,["element"]))),256))])):$("",!0)]),_:1}))],64))}}),Ye={key:0,class:"py-(--proseAsideWidth)"},Je=Z({__name:"Hint",props:{value:{}},async setup(e){let s,c;const n=([s,c]=H(()=>K()),s=await s,c(),s);return(l,o)=>(t(),h(ee,null,{default:y(()=>[e.value.length===1?(t(),i("div",Ye,[(t(!0),i(S,null,A(e.value[0].children,d=>(t(),h(j,{element:d},null,8,["element"]))),256))])):(t(!0),i(S,{key:1},A(e.value,(d,u)=>(t(),h(be,{title:a(n).action_hint+" "+(u+1),element:d},null,8,["title","element"]))),256))]),_:1}))}}),Qe={key:0,class:"py-(--proseAsideWidth)"},Y=Z({__name:"DefaultPlusSections",props:{value:{}},setup(e){const s=e.value.children.filter(n=>!_(n,ne)),c=e.value.children.filter(n=>_(n,ne));return(n,l)=>(t(),h(ee,null,{default:y(()=>[a(s).length?(t(),i("div",Qe,[(t(!0),i(S,null,A(a(s),o=>(t(),h(j,{element:o},null,8,["element"]))),256))])):$("",!0),a(c).length?(t(!0),i(S,{key:1},A(a(c),o=>(t(),h(be,{title:o.data,element:o},null,8,["title","element"]))),256)):$("",!0)]),_:1}))}}),ue=Z({__name:"ProblemButton",props:{active:{type:Boolean}},setup(e){return(s,c)=>(t(),i("button",{class:R([`bg-bg-main border-border/80 text-main-xs min-w-[50px]
            cursor-pointer rounded border px-2.5 py-[5px] font-semibold shadow
            shadow-[light-dark(#d9d9d9,#3c3c3c)]
            transition-[color,background,border,box-shadow]`,{"border-brand/50 bg-brand/10 text-brand":e.active,"text-text-muted hocus:text-brand hocus:border-brand/50":!e.active}])},[ie(s.$slots,"default")],2))}}),Xe={class:"gap-small flex w-full flex-col"},Ke=["placeholder"],et={class:"text-text-dimmed text-main-xs italic"},tt=Z({__name:"Check",props:{check:{},script:{}},async setup(e){let s,c;const n={default:{icon:fe,labelClass:"text-text-muted",inputClass:"border-border text-text",buttonClass:"text-text-muted border-border hocus:border-text-muted hocus:text-text"},correct:{icon:Fe,labelClass:"text-lime-600",inputClass:"text-lime-600 border-lime-500",buttonClass:"text-lime-600 border-lime-500"},wrong:{icon:X,iconClass:"rotate-45",labelClass:"text-red-700 dark:text-red-400",inputClass:"text-red-700 dark:text-red-400 border-red-400",buttonClass:"text-red-700 dark:text-red-400 border-red-400"}},l=k("default"),o=he(),{EruditIcon:d,EruditTransition:u}=V(),f=([s,c]=H(()=>K()),s=await s,c(),s),b=Q("answer"),C=k(""),E=k(null);Ee(C,()=>{l.value="default",E.value=null,e.script?.clear()});function m(){let M=C.value.trim().replace(/\s+/g," ")||void 0;if(M===E.value)return;if(E.value=M,e.script){const B=e.script.check(M);l.value=B?"correct":"wrong";return}const x=e.check.data.answers?.includes(M);l.value=x?"correct":"wrong"}return(M,x)=>(t(),i("div",Xe,[w("div",{class:R(["text-main-sm font-medium transition-[color]",n[l.value].labelClass])},[w("span",{onClick:x[0]||(x[0]=B=>b.value?.focus())},T(a(o)(e.check.data.label??a(f).action_answer)+":"),1)],2),w("form",{class:"flex",onSubmit:me(m,["prevent"])},[ve(w("input",{ref:"answer",type:"text",name:"answer","onUpdate:modelValue":x[1]||(x[1]=B=>C.value=B),placeholder:e.check.data.placeholder,autocomplete:"off",class:R([`bg-bg-main text-main-sm relative z-10 min-w-0 flex-1
                    rounded rounded-tr-none rounded-br-none border border-r-0
                    px-2.5 py-1 transition-[border,color,background]`,n[l.value].inputClass])},null,10,Ke),[[pe,C.value]]),w("button",{type:"submit",class:R([`bg-bg-main relative w-[50px] cursor-pointer rounded
                    rounded-tl-none rounded-bl-none border outline-0
                    transition-[border,color,background]`,n[l.value].buttonClass])},[(t(),h(a(d),{key:l.value,name:n[l.value].icon,class:R(["invisible m-auto text-[1.2em]",n[l.value].iconClass])},null,8,["name","class"])),I(a(u),null,{default:y(()=>[(t(),h(a(d),{key:l.value,name:n[l.value].icon,class:R([`absolute top-1/2 left-1/2 -translate-1/2
                            text-[1.2em]`,n[l.value].iconClass])},null,8,["name","class"]))]),_:1})],2)],32),w("div",et,T(e.check.data.hint?a(o)(e.check.data.hint):""),1)]))}}),st={class:"micro:grid-cols-2 grid gap-(--proseAsideWidth) p-(--proseAsideWidth)"},nt=Z({__name:"Checks",props:{value:{}},setup(e){const s=(o,d)=>{if(!e.value.checkFunction)return console.warn("No check function defined for script checks!"),!1;const u=e.value.checkFunction({answer:o,name:d,answers:l.value});return u===!0?l.value[d]=o:delete l.value[d],u},c=o=>{delete l.value[o]},n=new Map;for(const o of e.value.checkElements)o.data.script&&n.set(o,o.data.script);const l=k({});return(o,d)=>(t(),h(ee,null,{default:y(()=>[w("div",st,[(t(!0),i(S,null,A(e.value.checkElements,u=>(t(),h(tt,{check:u,script:u.data.script?{check:f=>{const b=a(n).get(u);return s(f,b)},clear:()=>{const f=a(n).get(u);c(f)}}:void 0},null,8,["check","script"]))),256))])]),_:1}))}}),at={key:0,class:"gap-small micro:gap-normal flex flex-wrap p-(--proseAsideWidth) pt-0"},lt=["title"],bt=Z({__name:"ProblemContent",props:{element:{},initialElements:{}},async setup(e){let s,c;const{EruditIcon:n,EruditTransition:l}=V(),o=([s,c]=H(()=>K()),s=await s,c(),s),d=Object.fromEntries(Object.entries(Object.assign({"../assets/actions/answer.svg":Te,"../assets/actions/check.svg":fe,"../assets/actions/generate.svg":De,"../assets/actions/hint.svg":We,"../assets/actions/note.svg":He,"../assets/actions/solution.svg":Ve})).map(([v,r])=>[v.split("/").pop()?.replace(".svg","")??v,r])),u=k(0),f=z(e.initialElements),b=L(()=>f.value.find(v=>_(v,Me))),C={check:nt,hint:Je,answer:Y,solution:Y,note:Y},E=L(()=>{const v={},r=f.value.filter(g=>_(g,Se));r.length>0&&(v.check={checkElements:r,checkFunction:q.value});const p=f.value.filter(g=>_(g,ae));return p.length>0&&(v.hint=p),["answer","solution","note"].forEach(g=>{const N=f.value.filter(U=>{switch(g){case"answer":return _(U,oe.schema);case"solution":return _(U,re.schema);case"note":return _(U,le.schema)}});N.length>0&&(v[g]=N[0])}),v}),m=k(),M=Be(f.value);de(()=>{const v=M.value;if(v===void 0)return;const r=f.value.at(v);switch(!0){case _(r,ae):m.value="hint";break;case _(r,oe.schema):m.value="answer";break;case _(r,re.schema):m.value="solution";break;case _(r,le.schema):m.value="note";break}});const x=z(),B=([s,c]=H(()=>Pe(e.element)),s=await s,c(),s),te=L(()=>!!x.value?.isGenerator),q=z();$e(async()=>{if(x.value=await je(B?.resolvedScriptSrc,e.element.data.scriptUniques),x.value){const v=x.value.generate(W);q.value=v.check}});const se=k(0),G=k(!1),P=k(W),D=k(!1);async function O(){if(!x.value||(se.value+=180,G.value))return;G.value=!0,D.value?D.value=!1:P.value=Math.floor(Math.random()*1e9)+1;const v=x.value.generate(P.value);v.check&&(q.value=v.check);const r=v.problemContent,p=[];for(const g of r){const N=await Ne({rawElement:g});p.push(N.proseElement)}f.value=p,u.value++,G.value=!1}const F=k(!1),xe=Q("seedReference"),ge=Q("seedPopup"),{floatingStyles:we}=Ie(xe,ge,{whileElementsMounted:Re,placement:"top"});return(v,r)=>(t(),i("div",null,[(t(),h(J,{suspensible:""},{default:y(()=>[(t(),i("div",{class:"py-(--proseAsideWidth)",key:u.value},[(t(!0),i(S,null,A(b.value.children,p=>(t(),h(j,{element:p},null,8,["element"]))),256))]))]),_:1})),Object.values(E.value).some(Boolean)||te.value?(t(),i("div",at,[(t(!0),i(S,null,A(E.value,(p,g)=>(t(),h(ue,{key:g,onClick:N=>m.value=g===m.value?void 0:g,active:g===m.value,class:"flex items-center gap-[7px]"},{default:y(()=>[I(a(n),{name:a(d)[g],class:"text-[1.3em]"},null,8,["name"]),w("span",null,T(a(o)[`action_${g}`]),1)]),_:2},1032,["onClick","active"]))),128)),te.value?(t(),i("div",{key:0,ref:"seedReference",onMouseenter:r[5]||(r[5]=p=>F.value=!0),onMouseleave:r[6]||(r[6]=p=>F.value=!1)},[I(ue,{onTouchstart:r[0]||(r[0]=p=>F.value=!F.value),onClick:O,class:"flex items-center gap-[7px]"},{default:y(()=>[I(a(n),{name:a(d).generate,style:ce({transform:`rotate(${se.value}deg)`}),class:"text-[1.3em] transition-[transform] backface-hidden"},null,8,["name","style"]),w("span",null,T(a(o).action_generate),1)]),_:1}),I(a(l),null,{default:y(()=>[F.value?(t(),i("div",{key:0,ref:"seedPopup",style:ce(a(we)),class:"pb-2.5"},[w("form",{class:"shadow-border text-main-xs flex rounded bg-neutral-900 text-white shadow-lg dark:bg-neutral-200 dark:text-black",onSubmit:me(O,["prevent"])},[ve(w("input",{type:"text","onUpdate:modelValue":r[1]||(r[1]=p=>P.value=p),onInput:r[2]||(r[2]=p=>D.value=!0),title:a(o).seed_explain,onFocus:r[3]||(r[3]=p=>p.target.select()),class:"max-w-[100px] flex-1 p-[5px] text-center outline-none"},null,40,lt),[[pe,P.value]]),P.value!==a(W)?(t(),i("button",{key:0,type:"button",onClick:r[4]||(r[4]=p=>{P.value=a(W),D.value=!0,O()}),class:"cursor-pointer pr-[3px]"},[I(a(n),{name:a(X),class:"hocus:text-white dark:hocus:text-black rotate-45 text-[1.3em] text-neutral-400 transition-[color] dark:text-neutral-600"},null,8,["name"])])):$("",!0)],32)],4)):$("",!0)]),_:1})],544)):$("",!0)])):$("",!0),(t(),h(J,{suspensible:""},{default:y(()=>[m.value?(t(),h(Ae(C[m.value]),{key:`${u.value}-${m.value}`,value:E.value[m.value]},null,8,["value"])):$("",!0)]),_:1}))]))}});export{bt as _,ue as a,K as u};
