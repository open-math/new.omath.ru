import{b as ke,aX as Ce,aY as ye,_ as Se,O as t,Q as p,R as C,am as de,X as T,aS as me,a2 as I,S as D,ac as c,T as P,ad as R,a1 as g,aZ as J,U as $,a3 as B,a5 as Z,Z as S,a9 as q,aU as y,a_ as ae,au as K,aB as Me,aT as ve,a$ as ee,b0 as pe,b1 as $e,b2 as Ee,ag as W,b3 as he,at as Y,$ as Ae,a4 as le,aM as Ie,b4 as Ze,b5 as oe,g as re,h as ce,j as ue}from"./D_GAU_kb.js";import{u as Be,a as Pe}from"./CVaqpPYf.js";import{u as G}from"./CP2XOIbp.js";import{a as Re,f as Te}from"./6yqU-1zY.js";import{u as Fe}from"./DUhOrFD9.js";import{D as j}from"./DidrgFjr.js";import{p as te}from"./y9Kl881g.js";import{_ as U}from"./BD6_BLMO.js";import{u as fe}from"./DHz_IMr8.js";import{s as Ne}from"./kHqF3ywV.js";/* empty css        */async function Ve(e){const{rawElement:n,pre:r,post:a,step:_,ids:m}=e,s=new Set(m),x={};async function w(h){let M;if(h.children){M=[];for(const i of h.children){const l=await w(i);M.push(l)}}r&&await r(h);const E=ke.getSchema(h.schemaName),d={...Ce("prose",E),data:h.data,storageKey:h.storageKey,children:M};return h.uniqueName&&(d.uniqueName=h.uniqueName,x[h.uniqueName]=d),a&&await a(d),_&&await _({rawElement:h,proseElement:d}),d}return{proseElement:await w(n),uniques:x,ids:s}}async function ne(){const{appElements:e,languageCode:n}=G();return await e[ye.name].languages[n]()}const We=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20">
  <path d="M8.86,13.75l5.75-5.75-1.14-1.14-4.61,4.61-2.32-2.32-1.14,1.14,3.47,3.47ZM10,18.15c-1.13,0-2.19-.21-3.18-.64-.99-.43-1.86-1.01-2.59-1.74-.73-.73-1.31-1.6-1.74-2.59-.43-.99-.64-2.05-.64-3.18,0-1.13.21-2.19.64-3.18s1.01-1.86,1.74-2.59c.73-.73,1.6-1.31,2.59-1.74s2.05-.64,3.18-.64c1.13,0,2.19.21,3.18.64.99.43,1.86,1.01,2.59,1.74.73.73,1.31,1.6,1.74,2.59.43.99.64,2.05.64,3.18s-.22,2.19-.64,3.18c-.43.99-1.01,1.86-1.74,2.59s-1.6,1.31-2.59,1.74c-.99.43-2.05.64-3.18.64M10,16.52c1.82,0,3.36-.63,4.63-1.9s1.9-2.81,1.9-4.63-.63-3.36-1.9-4.63c-1.26-1.26-2.81-1.9-4.63-1.9-1.82,0-3.36.63-4.63,1.9s-1.9,2.81-1.9,4.63c0,1.82.63,3.36,1.9,4.63,1.26,1.26,2.81,1.9,4.63,1.9"/>
</svg>`,be=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32">
  <path d="M28.58,6.4l-7.8,20.14c-.26.67-1.01,1-1.68.74-.16-.06-.3-.15-.43-.27l-4.39-4.21-2.7,2.7c-.26.26-.66.26-.92,0-.12-.12-.19-.29-.19-.46v-5.87l-6.74-6.46c-.52-.5-.54-1.32-.04-1.84.17-.18.38-.3.62-.36l22.74-5.84c.7-.18,1.4.24,1.58.94.06.26.05.54-.05.79h0ZM25.42,7.88l-14.25,9.29,2.26,2.16,12-11.45h0Z"/>
</svg>`,De=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16">
  <path d="M2,2v1.5h2.1l-.37.3c-.6.6-1.02,1.25-1.27,1.95-.3.7-.45,1.42-.45,2.17,0,1.4.42,2.65,1.27,3.75.8,1.05,1.87,1.77,3.22,2.17v-1.57c-.9-.35-1.62-.92-2.17-1.72-.55-.75-.82-1.62-.82-2.62,0-.55.1-1.07.3-1.57.2-.55.55-1.05,1.05-1.5l.15-.15v1.8h1.5V2H2ZM9.5,2.23v1.57c.9.3,1.62.85,2.17,1.65.55.75.82,1.62.82,2.62,0,.55-.1,1.07-.3,1.57-.25.55-.57,1.05-.97,1.5l-.22.15v-1.8h-1.5v4.5h4.5v-1.5h-2.02l.22-.22c.65-.65,1.1-1.32,1.35-2.02.3-.75.45-1.47.45-2.17,0-1.4-.42-2.65-1.27-3.75-.8-1.1-1.87-1.82-3.22-2.17v.07Z"/>
</svg>`,He=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 22 22">
  <path d="M11,6.36c2.56,0,4.64,2.08,4.64,4.64,0,1.72-.93,3.21-2.32,4.02v1.39c0,.43-.35.77-.77.77h-3.09c-.43,0-.77-.35-.77-.77v-1.39c-1.38-.8-2.32-2.3-2.32-4.02,0-2.56,2.08-4.64,4.64-4.64M12.55,17.95v.77c0,.43-.35.77-.77.77h-1.55c-.43,0-.77-.35-.77-.77v-.77h3.09ZM17.18,10.23h2.32v1.55h-2.32v-1.55ZM2.5,10.23h2.32v1.55h-2.32v-1.55ZM11.77,2.5v2.32h-1.55v-2.32h1.55ZM5.53,4.43l1.65,1.65-1.1,1.09-1.65-1.64,1.1-1.1ZM14.83,6.08l1.64-1.65,1.11,1.1-1.65,1.64-1.1-1.1Z"/>
</svg>`,Oe=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16.97 16.97">
  <path d="M10.41,4.64c0-.31.2-.57.43-.79.21-.2.34-.45.34-.72,0-.63-.69-1.15-1.53-1.15s-1.53.51-1.53,1.15c0,.28.13.53.35.73.22.2.42.46.42.76,0,.41-.33.74-.74.75-.02,0-.03,0-.05,0-.77-.05-1.54-.13-2.31-.23-.31-.04-.6.17-.65.49,0,.05,0,.11,0,.16.11.76.19,1.53.23,2.31.02.41-.29.76-.7.78-.02,0-.03,0-.05,0-.3,0-.56-.19-.76-.42-.2-.22-.45-.35-.73-.35-.63,0-1.15.69-1.15,1.53s.51,1.53,1.15,1.53c.27,0,.52-.13.72-.34.21-.23.48-.43.79-.43.42,0,.77.34.77.76,0,.01,0,.02,0,.03-.04.96-.12,1.91-.24,2.86-.04.31.18.6.49.64.8.11,1.62.19,2.44.24.41.02.76-.29.78-.7,0-.02,0-.03,0-.05,0-.3-.19-.56-.42-.76-.22-.2-.35-.45-.35-.73,0-.63.69-1.15,1.53-1.15s1.53.51,1.53,1.15c0,.27-.13.52-.34.72-.23.21-.43.48-.43.79,0,.42.34.77.76.77,0,0,.02,0,.03,0,1.02-.04,2.04-.12,3.03-.26.26-.03.46-.24.49-.49.13-1,.22-2.01.26-3.03.01-.42-.32-.78-.74-.79,0,0-.02,0-.03,0-.31,0-.57.2-.79.43-.2.21-.45.34-.72.34-.63,0-1.15-.69-1.15-1.53s.51-1.53,1.15-1.53c.28,0,.53.13.73.35.2.22.46.42.76.42.41,0,.75-.33.75-.74,0-.02,0-.03,0-.05-.05-.82-.13-1.63-.24-2.44-.04-.31-.33-.53-.64-.49-.94.13-1.89.21-2.86.24-.42.01-.77-.32-.79-.74,0-.01,0-.02,0-.03"/>
</svg>`,je=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 560">
  <path d="M119.1,480c-8.15,0-14.95-2.75-20.41-8.26-5.51-5.45-8.26-12.25-8.26-20.41s2.75-14.9,8.26-20.41c5.45-5.45,12.25-8.18,20.41-8.18h229.09c8.15,0,14.95,2.73,20.41,8.18s8.26,12.31,8.26,20.41c0,8.15-2.75,14.95-8.26,20.41-5.45,5.51-12.25,8.26-20.41,8.26H119.1ZM119.1,365.42c-8.1,0-14.9-2.75-20.41-8.26-5.45-5.45-8.18-12.25-8.18-20.41s2.73-14.9,8.18-20.41c5.51-5.45,12.31-8.18,20.41-8.18h401c8.15,0,14.95,2.73,20.41,8.18,5.51,5.51,8.26,12.31,8.26,20.41s-2.75,14.95-8.26,20.41c-5.45,5.51-12.25,8.26-20.41,8.26H119.1ZM119.1,250.83c-8.1,0-14.9-2.73-20.41-8.18-5.45-5.51-8.18-12.31-8.18-20.41s2.73-14.95,8.18-20.41c5.51-5.51,12.31-8.26,20.41-8.26h401c8.15,0,14.95,2.75,20.41,8.26,5.51,5.45,8.26,12.25,8.26,20.41s-2.75,14.9-8.26,20.41c-5.45,5.45-12.25,8.18-20.41,8.18H119.1ZM119.1,136.25c-8.1,0-14.9-2.73-20.41-8.18-5.45-5.51-8.18-12.31-8.18-20.41s2.73-14.95,8.18-20.41c5.51-5.51,12.31-8.26,20.41-8.26h401c8.15,0,14.95,2.75,20.41,8.26,5.51,5.45,8.26,12.25,8.26,20.41s-2.75,14.9-8.26,20.41c-5.45,5.45-12.25,8.18-20.41,8.18H119.1Z"/>
</svg>`;async function qe(e,n){if(!e||!n)return;const a=(await import(e)).default;return a(n)}const Ge={},Ue={class:"border-border border-t"};function ze(e,n){return t(),p("div",null,[C("div",Ue,[de(e.$slots,"default")])])}const se=Se(Ge,[["render",ze]]),Le={class:"flex-1"},Xe={class:"group-hocus:bg-border/80 text-text-muted shrink-0 rounded bg-transparent p-0.5 transition-[background]"},Ye={key:0,class:"border-border border-t border-dashed py-(--proseAsideWidth)"},ge=T({__name:"ProblemExpanderSection",props:{title:{},element:{}},setup(e){const n=fe(),{EruditIcon:r}=G(),a=S(!1),_=Re(e.element);return me(()=>{_.value&&(a.value=!0)}),(m,s)=>(t(),p(I,null,[C("div",{onClick:s[0]||(s[0]=x=>a.value=!a.value),class:"group border-border text-text-muted relative flex cursor-pointer items-center border-t p-(--proseAsideWidth) font-semibold first:border-t-0"},[C("div",Le,D(c(n)(e.title)),1),C("button",Xe,[P(c(r),{name:c(te),class:R(["micro:text-[26px] text-[22px] transition-[rotate]",a.value?"rotate-45":""])},null,8,["name","class"])])]),(t(),g(J,null,{default:$(()=>[a.value?(t(),p("div",Ye,[(t(!0),p(I,null,B(e.element.children,x=>(t(),g(U,{element:x},null,8,["element"]))),256))])):Z("",!0)]),_:1}))],64))}}),Qe={key:0,class:"py-(--proseAsideWidth)"},Je=T({__name:"Hint",props:{value:{}},async setup(e){let n,r;const a=([n,r]=q(()=>ne()),n=await n,r(),n);return(_,m)=>(t(),g(se,null,{default:$(()=>[e.value.length===1?(t(),p("div",Qe,[(t(!0),p(I,null,B(e.value[0].children,s=>(t(),g(U,{element:s},null,8,["element"]))),256))])):(t(!0),p(I,{key:1},B(e.value,(s,x)=>(t(),g(ge,{title:c(a).action_hint+" "+(x+1),element:s},null,8,["title","element"]))),256))]),_:1}))}}),Ke={key:0,class:"py-(--proseAsideWidth)"},Q=T({__name:"DefaultPlusSections",props:{value:{}},setup(e){const n=e.value.children.filter(a=>!y(a,ae)),r=e.value.children.filter(a=>y(a,ae));return(a,_)=>(t(),g(se,null,{default:$(()=>[c(n).length?(t(),p("div",Ke,[(t(!0),p(I,null,B(c(n),m=>(t(),g(U,{element:m},null,8,["element"]))),256))])):Z("",!0),c(r).length?(t(!0),p(I,{key:1},B(c(r),m=>(t(),g(ge,{title:m.data,element:m},null,8,["title","element"]))),256)):Z("",!0)]),_:1}))}}),ie=T({__name:"ProblemButton",props:{active:{type:Boolean}},setup(e){return(n,r)=>(t(),p("button",{class:R([`bg-bg-main border-border/80 text-main-xs micro:px-2.5 min-w-[30px]
      cursor-pointer rounded border px-1.5 py-[5px] font-semibold shadow
      shadow-[light-dark(#d9d9d9,#3c3c3c)]
      transition-[color,background,border,box-shadow]`,{"border-brand/50 bg-brand/10 text-brand":e.active,"text-text-muted hocus:text-brand hocus:border-brand/50":!e.active}])},[de(n.$slots,"default")],2))}}),et={class:"gap-small flex w-full flex-col"},tt=["placeholder"],nt={class:"text-text-dimmed text-main-xs italic"},st=T({__name:"Check",props:{check:{},script:{}},emits:["status-change"],async setup(e,{emit:n}){let r,a;const _=n,m={default:{icon:be,labelClass:"text-text-muted",inputClass:"border-border text-text",buttonClass:"text-text-muted border-border hocus:border-text-muted hocus:text-text"},correct:{icon:Ne,labelClass:"text-lime-600",inputClass:"text-lime-600 border-lime-500",buttonClass:"text-lime-600 border-lime-500"},wrong:{icon:te,iconClass:"rotate-45",labelClass:"text-red-700 dark:text-red-400",inputClass:"text-red-700 dark:text-red-400 border-red-400",buttonClass:"text-red-700 dark:text-red-400 border-red-400"}},s=S("default"),x=fe(),{EruditIcon:w,EruditTransition:h}=G(),M=([r,a]=q(()=>ne()),r=await r,a(),r),E=K("answer"),d=S(""),i=S(null);Me(d,()=>{s.value="default",i.value=null,e.script?.clear(),_("status-change","default")});function l(){const o=d.value.trim().replace(/\s+/g," ")||void 0;if(o!==i.value){if(i.value=o,e.script){const v=e.script.check(o);s.value=v?"correct":"wrong",_("status-change",s.value);return}s.value=$e(o,e.check.data)?"correct":"wrong",_("status-change",s.value)}}return(o,v)=>(t(),p("div",et,[C("div",{class:R(["text-main-sm font-medium transition-[color]",m[s.value].labelClass])},[C("span",{onClick:v[0]||(v[0]=A=>E.value?.focus())},D(c(x)(e.check.data.label??c(M).action_answer)+":"),1)],2),C("form",{class:"flex",onSubmit:ve(l,["prevent"])},[ee(C("input",{ref:"answer","onUpdate:modelValue":v[1]||(v[1]=A=>d.value=A),type:"text",autocomplete:"off",placeholder:e.check.data.placeholder,class:R([`bg-bg-main text-main-sm relative z-10 min-w-0 flex-1 rounded
          rounded-tr-none rounded-br-none border border-r-0 px-2.5 py-1
          transition-[border,color,background]`,m[s.value].inputClass])},null,10,tt),[[pe,d.value]]),C("button",{type:"submit",class:R([`bg-bg-main relative w-[50px] cursor-pointer rounded rounded-tl-none
          rounded-bl-none border outline-0 transition-[border,color,background]`,m[s.value].buttonClass])},[(t(),g(c(w),{key:s.value,name:m[s.value].icon,class:R(["invisible m-auto text-[1.2em]",m[s.value].iconClass])},null,8,["name","class"])),P(c(h),null,{default:$(()=>[(t(),g(c(w),{key:s.value,name:m[s.value].icon,class:R(["absolute top-1/2 left-1/2 -translate-1/2 text-[1.2em]",m[s.value].iconClass])},null,8,["name","class"]))]),_:1})],2)],32),C("div",nt,D(e.check.data.hint?c(x)(e.check.data.hint):""),1)]))}}),at={class:"micro:grid-cols-2 grid gap-(--proseAsideWidth) p-(--proseAsideWidth)"},lt=T({__name:"Checks",props:{value:{}},setup(e){let n=0;const r=new WeakMap;function a(i){return r.has(i)||r.set(i,`check-${++n}`),r.get(i)}function _(i,l){const o=[];for(const v of i){v._parent=l??null,o.push(v);const A=(v.children??[]).filter(H=>y(H,he));A.length&&o.push(..._(A,v))}return o}const m=W(()=>_(e.value.checkElements)),s=S({});function x(i,l){s.value[a(i)]=l}function w(i){const l=i._parent;if(!l)return!0;let o=l;for(;o;){if(s.value[a(o)]!=="correct")return!1;o=o._parent}return!0}const h=S({}),M=W(()=>{const i=new Map;for(const l of m.value)l.data.script&&i.set(l,l.data.script);return i});function E(i,l){if(!e.value.checkFunction)return console.warn("No check function defined for script checks!"),!1;const o=M.value.get(i),v=e.value.checkFunction({name:o,answer:l,answers:h.value});return v===!0?h.value[o]=l:delete h.value[o],v}function d(i){const l=M.value.get(i);l&&delete h.value[l]}return(i,l)=>(t(),g(se,null,{default:$(()=>[C("div",at,[(t(!0),p(I,null,B(m.value,o=>ee((t(),g(st,{key:a(o),check:o,script:o.data.script?{check:v=>E(o,v),clear:()=>d(o)}:void 0,onStatusChange:v=>x(o,v)},null,8,["check","script","onStatusChange"])),[[Ee,w(o)]])),128))])]),_:1}))}}),ot={key:0,class:"gap-small micro:gap-normal flex flex-wrap p-(--proseAsideWidth) pt-0"},rt=["title"],xt=T({__name:"ProblemContent",props:{element:{},initialElements:{}},async setup(e){let n,r;const{EruditIcon:a,EruditTransition:_}=G(),m=([n,r]=q(()=>ne()),n=await n,r(),n),s=Object.fromEntries(Object.entries(Object.assign({"../assets/actions/answer.svg":We,"../assets/actions/check.svg":be,"../assets/actions/generate.svg":De,"../assets/actions/hint.svg":He,"../assets/actions/note.svg":Oe,"../assets/actions/solution.svg":je})).map(([f,u])=>[f.split("/").pop()?.replace(".svg","")??f,u])),x=S(0),w=Y(e.initialElements),h=W(()=>w.value.find(f=>y(f,Ze))),M={check:lt,hint:Je,answer:Q,solution:Q,note:Q},E=W(()=>{const f={},u=w.value.filter(k=>y(k,he));u.length>0&&(f.check={checkElements:u,checkFunction:A.value});const b=w.value.filter(k=>y(k,oe));return b.length>0&&(f.hint=b),["answer","solution","note"].forEach(k=>{const V=w.value.filter(X=>{switch(k){case"answer":return y(X,ue.schema);case"solution":return y(X,ce.schema);case"note":return y(X,re.schema)}});V.length>0&&(f[k]=V[0])}),f}),d=S(),i=Te(w.value);me(()=>{const f=i.value;if(f===void 0)return;const u=w.value.at(f);switch(!0){case y(u,oe):d.value="hint";break;case y(u,ue.schema):d.value="answer";break;case y(u,ce.schema):d.value="solution";break;case y(u,re.schema):d.value="note";break}});const l=Y(),o=([n,r]=q(()=>Fe(e.element)),n=await n,r(),n),v=W(()=>!!l.value?.isGenerator),A=Y();Ae(async()=>{if(l.value=await qe(o?.resolvedScriptSrc,e.element.data.scriptUniques),l.value){const f=l.value.generate(j);A.value=f.check}});const H=S(0),z=S(!1),F=S(j),O=S(!1);async function L(){if(!l.value||(H.value+=180,z.value))return;z.value=!0,O.value?O.value=!1:F.value=Math.floor(Math.random()*1e9)+1;const f=l.value.generate(F.value);f.check&&(A.value=f.check);const u=f.problemContent,b=[];for(const k of u){const V=await Ve({rawElement:k});b.push(V.proseElement)}w.value=b,x.value++,z.value=!1}const N=S(!1),xe=K("seedReference"),_e=K("seedPopup"),{floatingStyles:we}=Be(xe,_e,{whileElementsMounted:Pe,placement:"top"});return(f,u)=>(t(),p("div",null,[(t(),g(J,{suspensible:""},{default:$(()=>[(t(),p("div",{class:"py-(--proseAsideWidth)",key:x.value},[(t(!0),p(I,null,B(h.value.children,b=>(t(),g(U,{element:b},null,8,["element"]))),256))]))]),_:1})),Object.values(E.value).some(Boolean)||v.value?(t(),p("div",ot,[(t(!0),p(I,null,B(E.value,(b,k)=>(t(),g(ie,{key:k,onClick:V=>d.value=k===d.value?void 0:k,active:k===d.value,class:"flex items-center gap-[7px]"},{default:$(()=>[P(c(a),{name:c(s)[k],class:"text-[1.3em]"},null,8,["name"]),C("span",null,D(c(m)[`action_${k}`]),1)]),_:2},1032,["onClick","active"]))),128)),v.value?(t(),p("div",{key:0,ref:"seedReference",onMouseenter:u[5]||(u[5]=b=>N.value=!0),onMouseleave:u[6]||(u[6]=b=>N.value=!1)},[P(ie,{onTouchstart:u[0]||(u[0]=b=>N.value=!N.value),onClick:L,class:"flex items-center gap-[7px]"},{default:$(()=>[P(c(a),{name:c(s).generate,style:le({transform:`rotate(${H.value}deg)`}),class:"text-[1.3em] transition-[transform] backface-hidden"},null,8,["name","style"]),C("span",null,D(c(m).action_generate),1)]),_:1}),P(c(_),null,{default:$(()=>[N.value?(t(),p("div",{key:0,ref:"seedPopup",style:le(c(we)),class:"pb-2.5"},[C("form",{class:"shadow-border text-main-xs flex rounded bg-neutral-900 text-white shadow-lg dark:bg-neutral-200 dark:text-black",onSubmit:ve(L,["prevent"])},[ee(C("input",{type:"text","onUpdate:modelValue":u[1]||(u[1]=b=>F.value=b),onInput:u[2]||(u[2]=b=>O.value=!0),title:c(m).seed_explain,onFocus:u[3]||(u[3]=b=>b.target.select()),class:"max-w-[100px] flex-1 p-[5px] text-center outline-none"},null,40,rt),[[pe,F.value]]),F.value!==c(j)?(t(),p("button",{key:0,type:"button",onClick:u[4]||(u[4]=b=>{F.value=c(j),O.value=!0,L()}),class:"cursor-pointer pr-[3px]"},[P(c(a),{name:c(te),class:"hocus:text-white dark:hocus:text-black rotate-45 text-[1.3em] text-neutral-400 transition-[color] dark:text-neutral-600"},null,8,["name"])])):Z("",!0)],32)],4)):Z("",!0)]),_:1})],544)):Z("",!0)])):Z("",!0),(t(),g(J,{suspensible:""},{default:$(()=>[d.value?(t(),g(Ie(M[d.value]),{key:`${x.value}-${d.value}`,value:E.value[d.value]},null,8,["value"])):Z("",!0)]),_:1}))]))}});export{xt as _,ie as a,ne as u};
