import{s as E,_ as A}from"./B2GIkhMo.js";import{W as U,X as J,as as R,ai as L,a8 as C,ab as O,N as n,O as p,a3 as P,ac as t,P as r,R as _,a5 as V,S,Q as I,ae as M,a0 as q,a4 as d,U as $,al as j,af as D,ak as G,Y as B,a7 as K,a9 as T,Z as W,ag as z,at as X}from"./CmFBBqW5.js";const Y={class:"shrink-0"},Z={class:"p-small micro:p-normal relative flex-1 rounded rounded-tl-none border-2 border-(--colorBorder) bg-(--colorBg)"},F={class:"gap-small flex flex-col font-serif text-(--colorText)"},H={class:"text-main-sm gap-normal flex flex-wrap font-semibold"},ee={class:"flex-1"},oe={key:2},te={key:0,class:"gap-normal micro:text-[1.5em] flex items-center text-[1.2em]"},ae=["title"],ne=U({__name:"MainQuote",props:{quote:{},canJoin:{type:Boolean},hasNextLink:{type:Boolean}},emits:["next"],async setup(o,{emit:c}){let l,x;const i=c,y=J(),k=R(),f=o.quote.color??E(o.quote.name),w=(()=>{const e=o.quote.type==="cameo"?o.quote.messages:[...o.quote.messages??[],...L.config.sponsors?.defaultSponsorMessages],a=Math.floor(Math.random()*e.length);return e[a]})(),g=o.quote.type==="cameo"||o.quote.avatarUrl?y(o.quote.avatarUrl):"diamond";function b(){i("next"),setTimeout(()=>{u.value=k},400)}const u=B("arrow/left"),v=([l,x]=C(()=>O("add_quote","next_quote")),l=await l,x(),l);return(e,a)=>{const m=A,s=V,h=G,Q=j;return n(),p("div",{style:P({"--color":t(f),"--colorBorder":"color-mix(in srgb, var(--color), var(--color-border) 70%)","--colorBg":"color-mix(in srgb, var(--color), var(--color-bg-main) 85%)","--colorText":"color-mix(in srgb, var(--color), var(--color-text) 85%)","--colorIcon":"color-mix(in srgb, var(--color), var(--color-text) 30%)"}),class:"micro:gap-[40px] flex gap-[30px]"},[r("div",Y,[_(s,{external:"",target:"_blank",to:o.quote.link,class:"block rounded-full ring-2 ring-(--colorBorder)"},{default:S(()=>[_(m,{url:t(g),class:"border-bg-main micro:size-[60px] size-[40px] rounded-full border-2 [box-shadow:0_0_16px_0_var(--color)] [--mediaColor:var(--color)]"},null,8,["url"])]),_:1},8,["to"])]),r("div",Z,[a[0]||(a[0]=r("div",{class:"micro:[--arrowSize:22px] absolute -top-[2px] -left-(--arrowSize) h-(--arrowSize) w-(--arrowSize) bg-(--colorBorder) [--arrowSize:14px] [--arrowSizeSmall:calc(var(--arrowSize)-2px)] [clip-path:polygon(110%_0,110%_110%,0_0)]"},[r("div",{class:"absolute top-[2px] -right-[3px] h-(--arrowSizeSmall) w-(--arrowSizeSmall) bg-(--colorBg) [clip-path:polygon(100%_0,100%_100%,0_0)]"})],-1)),r("div",F,[r("div",null,I(("formatText"in e?e.formatText:t(M))(t(w))),1),r("div",H,[r("div",ee,[o.quote.type==="cameo"||o.quote.avatarUrl?(n(),q(h,{key:0,class:"relative -top-[1.5px] mr-1.5 inline text-(--colorIcon)",name:o.quote.icon},null,8,["name"])):d("",!0),o.quote.link?(n(),q(s,{key:1,external:"",to:o.quote.link,target:"_blank",class:"text-hover-underline"},{default:S(()=>[$(I(("formatText"in e?e.formatText:t(M))(o.quote.name)),1)]),_:1},8,["to"])):(n(),p("span",oe,I(("formatText"in e?e.formatText:t(M))(o.quote.name)),1)),o.quote.link?(n(),q(Q,{key:3,name:"arrow/outward",class:"relative -top-1 -right-1 inline text-(--colorText)/40"})):d("",!0)]),o.canJoin||o.hasNextLink?(n(),p("div",te,[o.canJoin?(n(),q(s,{key:0,to:("PAGES"in e?e.PAGES:t(D)).sponsors,title:t(v).add_quote,class:"hocus:text-(--colorIcon) text-(--colorIcon)/40 transition-[color]"},{default:S(()=>[_(Q,{name:"plus"})]),_:1},8,["to","title"])):d("",!0),o.hasNextLink?(n(),p("button",{key:1,onClick:b,title:t(v).next_quote,class:"hocus:text-(--colorIcon) cursor-pointer text-(--colorIcon)/40 transition-[color]"},[_(h,{name:t(u),class:"-scale-x-100"},null,8,["name"])],8,ae)):d("",!0)])):d("",!0)])])])],4)}}}),se=Object.assign(ne,{__name:"MainQuote"}),N="quote-ids",re=U({__name:"MainQuoteLoader",async setup(o){let c,l;const x=K(),i=x.static.data[N]||=x.payload.data[N]||=([c,l]=C(()=>T("/api/quote/ids")),c=await c,l(),c),y=z(()=>Object.values(i).reduce((e,a)=>e+(a?.length??0),0)),k=z(()=>y.value>1),f=B();function w(){const e=[];for(const s in i){const h=i[s];h&&e.push(...h)}if(e.length===1)return e[0];const a=f.value?e.filter(s=>s!==f.value):e,m=Math.floor(Math.random()*a.length);return a[m]}const g=X(),b=B(0);let u=!1;async function v(){u=!0;const e=w();f.value=e;const a=await T(`/api/quote/data/${e}`);g.value=a,b.value++,u=!1}return W(()=>{Object.keys(i).length!==0&&v()}),(e,a)=>{const m=se;return t(g)?(n(),p("section",{key:t(b),class:"px-main py-main-half"},[_(m,{quote:t(g),canJoin:("ERUDIT"in e?e.ERUDIT:t(L)).config.sponsors?.enabled,hasNextLink:t(k),onNext:a[0]||(a[0]=s=>!t(u)&&v())},null,8,["quote","canJoin","hasNextLink"])])):d("",!0)}}}),ie=Object.assign(re,{__name:"MainQuoteLoader"});export{ie as _};
