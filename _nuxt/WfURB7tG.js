import{_ as U,c as F,a as O}from"./DYjXd6h4.js";import{b as V,c as L}from"./jgsOFUCW.js";import{s as w,_ as R}from"./B37EUJiU.js";import{a as T,U as D,o as J,ai as K,k as n,l as _,x as $,f as b,t as k,e as u,F as P,r as B,R as j,g as a,G as N,Q,A as W,B as q,n as S,aj as H,C as X,v as I,u as t,S as Y,J as M,P as A,c as Z}from"./DPlMRrvx.js";import{_ as ee}from"./-8W5e4fZ.js";import"./B1Zwamhq.js";const te={class:"group-hocus:text-brand text-text-muted text-main-lg font-semibold transition-[color]"},ne={class:"flex gap-1.5"},oe={key:0,class:"group-hocus:text-brand group-hocus:border-brand border-text-dimmed text-text-muted grid size-(--avatarSize) place-items-center rounded-full border-3 border-dashed text-[17px] leading-none font-semibold transition-[color,border]"},se=2500,re=T({__name:"IndexPagePersons",props:{personType:{},title:{},link:{},persons:{}},setup(l){const o=Object.keys(l.persons),c=o.length,x=Math.min(4,c),h=c-x,e=D(Array.from({length:x},(m,i)=>({personId:`dummy-${i}`,url:void 0,color:void 0})));let g;function y(m,i){return i===0?l.personType==="contributor"?"user":"diamond":N(`/file/${l.personType}s/${m}/avatar.${i}`)}function s(m){return m[Math.floor(Math.random()*m.length)]}return J(()=>{const i=[...o].sort(()=>Math.random()-.5).slice(0,x);e.value=i.map(r=>({personId:r,url:y(r,l.persons[r]),color:w(r)})),!(c<=x)&&(g=window.setInterval(()=>{const r=e.value.map(v=>v.personId),f=o.filter(v=>!r.includes(v));if(!f.length)return;const d=Math.floor(Math.random()*e.value.length),p=s(f);e.value[d]={personId:p,url:y(p,l.persons[p]),color:w(p)}},se))}),K(()=>{g&&clearInterval(g)}),(m,i)=>{const r=R,f=Q;return n(),_(f,{to:l.link,class:"group gap-normal flex flex-col items-center [--avatarSize:50px]"},{default:$(()=>[b("div",te,k(l.title),1),b("div",ne,[(n(!0),u(P,null,B(e.value,d=>(n(),_(r,{key:d.personId,url:d.url,style:j({"--mediaColor":d.color}),class:"size-(--avatarSize) rounded-full"},null,8,["url","style"]))),128)),h?(n(),u("div",oe,k("+"+h),1)):a("",!0)])]),_:1},8,["to"])}}}),ae=Object.assign(re,{__name:"IndexPagePersons"}),ie=["src"],le={class:"px-main gap-normal py-main flex flex-col items-center text-center"},ce={class:"micro:text-[1.3em] text-text-muted text-[1.1em] font-semibold"},me={key:0,class:"gap-small micro:gap-normal micro:text-[1.2em] flex flex-wrap justify-center text-[1.1em]"},ue={key:1,class:"micro:text-justify px-main pb-main text-center"},de={key:2,class:"px-main pb-main gap-main flex flex-wrap justify-around"},C="index-page",ye=T({__name:"index",async setup(l){let o,c;const{showNewsAside:x}=W();x();const h=q(),e=h.static.data[C]||=h.payload.data[C]||=([o,c]=S(()=>$fetch("/api/indexPage",{responseType:"json"})),o=await o,c(),o);H(e);const g=Z(()=>e.topImage?.invert?e.topImage.invert==="dark"?"dark:hue-rotate-180 dark:invert-100":e.topImage.invert==="light"?"hue-rotate-180 invert-100 dark:hue-rotate-0 dark:invert-0":"":""),y=([o,c]=S(()=>X("x_contributors","x_sponsors")),o=await o,c(),o);return(s,m)=>{const i=U,r=F,f=V,d=L,p=ae,v=O,z=ee;return n(),u(P,null,[I(i),I(v,null,{default:$(()=>[t(e).topImage?(n(),u("img",{key:0,src:("withBaseUrl"in s?s.withBaseUrl:t(N))(t(e).topImage.src),style:j({"max-width":`min(${t(e).topImage.maxWidth||"100%"}, 100%)`}),class:Y(["pt-main-half px-main mx-auto block",t(g)])},null,14,ie)):a("",!0),b("div",le,[b("h1",null,[I(r,{text:t(e).title,class:"text-size-h1"},null,8,["text"])]),b("div",ce,k(("formatText"in s?s.formatText:t(M))(t(e).short)),1),t(e).stats?(n(),u("div",me,[t(e).stats.materials?(n(),_(f,{key:0,count:t(e).stats.materials,mode:"compact"},null,8,["count"])):a("",!0),t(e).stats.elements?(n(!0),u(P,{key:1},B(t(e).stats.elements,(E,G)=>(n(),_(d,{schemaName:G,count:E,mode:"compact"},null,8,["schemaName","count"]))),256)):a("",!0)])):a("",!0)]),t(e).description?(n(),u("div",ue,k(("formatText"in s?s.formatText:t(M))(t(e).description)),1)):a("",!0),t(e).contributors||t(e).sponsors?(n(),u("div",de,[t(e).contributors?(n(),_(p,{key:0,personType:"contributor",title:t(y).x_contributors(Object.keys(t(e).contributors).length),link:("PAGES"in s?s.PAGES:t(A)).contributors,persons:t(e).contributors},null,8,["title","link","persons"])):a("",!0),t(e).sponsors?(n(),_(p,{key:1,personType:"sponsor",title:t(y).x_sponsors(Object.keys(t(e).sponsors).length),link:("PAGES"in s?s.PAGES:t(A)).sponsors,persons:t(e).sponsors},null,8,["title","link","persons"])):a("",!0)])):a("",!0)]),_:1}),t(e).children?(n(),_(z,{key:0,children:t(e).children},null,8,["children"])):a("",!0)],64)}}});export{ye as default};
