import{_ as O,a as F,b as V}from"./BWYmwNqN.js";import{_ as L,a as R}from"./kkX2Jesd.js";import{s as w,_ as D}from"./DWK080-R.js";import{X as C,Y as B,Z as K,$ as Q,a0 as W,O as n,a1 as _,U as N,R as k,S as I,Q as u,a2 as S,a3 as j,a4 as z,a5 as a,a6 as X,a7 as Y,a8 as Z,a9 as M,aa as q,ab as H,T as P,ac as t,ad as J,ae as A,af as T,ag as ee}from"./DtnvSbKK.js";import{_ as te}from"./K4Mlq_ld.js";import"./CJ5ok-oq.js";const ne={class:"group-hocus:text-brand text-text-muted text-main-lg font-semibold transition-[color]"},oe={class:"flex gap-1.5"},se={key:0,class:"group-hocus:text-brand group-hocus:border-brand border-text-dimmed text-text-muted grid size-(--avatarSize) place-items-center rounded-full border-3 border-dashed text-[17px] leading-none font-semibold transition-[color,border]"},re=2500,ae=C({__name:"IndexPagePersons",props:{personType:{},title:{},link:{},persons:{}},setup(l){const o=B(),c=Object.keys(l.persons),h=c.length,x=Math.min(4,h),g=h-x,e=K(Array.from({length:x},(m,i)=>({personId:`dummy-${i}`,url:void 0,color:void 0})));let y;function b(m,i){return i===0?l.personType==="contributor"?"user":"diamond":o(`/file/${l.personType}s/${m}/avatar.${i}`)}function s(m){return m[Math.floor(Math.random()*m.length)]}return Q(()=>{const i=[...c].sort(()=>Math.random()-.5).slice(0,x);e.value=i.map(r=>({personId:r,url:b(r,l.persons[r]),color:w(r)})),!(h<=x)&&(y=window.setInterval(()=>{const r=e.value.map(v=>v.personId),f=c.filter(v=>!r.includes(v));if(!f.length)return;const d=Math.floor(Math.random()*e.value.length),p=s(f);e.value[d]={personId:p,url:b(p,l.persons[p]),color:w(p)}},re))}),W(()=>{y&&clearInterval(y)}),(m,i)=>{const r=D,f=X;return n(),_(f,{to:l.link,class:"group gap-normal flex flex-col items-center [--avatarSize:50px]"},{default:N(()=>[k("div",ne,I(l.title),1),k("div",oe,[(n(!0),u(S,null,j(e.value,d=>(n(),_(r,{key:d.personId,url:d.url,style:z({"--mediaColor":d.color}),class:"size-(--avatarSize) rounded-full"},null,8,["url","style"]))),128)),g?(n(),u("div",se,I("+"+g),1)):a("",!0)])]),_:1},8,["to"])}}}),ie=Object.assign(ae,{__name:"IndexPagePersons"}),le=["src"],ce={class:"px-main gap-normal py-main flex flex-col items-center text-center"},me={class:"micro:text-[1.3em] text-text-muted text-[1.1em] font-semibold"},ue={key:0,class:"gap-small micro:gap-normal micro:text-[1.2em] flex flex-wrap justify-center text-[1.1em]"},de={key:1,class:"micro:text-justify px-main pb-main text-center"},pe={key:2,class:"px-main pb-main gap-main flex flex-wrap justify-around"},$="index-page",be=C({__name:"index",async setup(l){let o,c;const{showNewsAside:h}=Y();h();const x=B(),g=Z(),e=g.static.data[$]||=g.payload.data[$]||=([o,c]=M(()=>$fetch("/api/indexPage",{responseType:"json"})),o=await o,c(),o);q(e);const y=ee(()=>e.topImage?.invert?e.topImage.invert==="dark"?"dark:hue-rotate-180 dark:invert-100":e.topImage.invert==="light"?"hue-rotate-180 invert-100 dark:hue-rotate-0 dark:invert-0":"":""),b=([o,c]=M(()=>H("x_contributors","x_sponsors")),o=await o,c(),o);return(s,m)=>{const i=O,r=F,f=L,d=R,p=ie,v=V,E=te;return n(),u(S,null,[P(i),P(v,null,{default:N(()=>[t(e).topImage?(n(),u("img",{key:0,src:t(x)(t(e).topImage.src),style:z({"max-width":`min(${t(e).topImage.maxWidth||"100%"}, 100%)`}),class:J(["pt-main-half px-main mx-auto block",t(y)])},null,14,le)):a("",!0),k("div",ce,[k("h1",null,[P(r,{text:t(e).title,class:"text-size-h1"},null,8,["text"])]),k("div",me,I(("formatText"in s?s.formatText:t(A))(t(e).short)),1),t(e).stats?(n(),u("div",ue,[t(e).stats.materials?(n(),_(f,{key:0,count:t(e).stats.materials,mode:"compact"},null,8,["count"])):a("",!0),t(e).stats.elements?(n(!0),u(S,{key:1},j(t(e).stats.elements,(G,U)=>(n(),_(d,{schemaName:U,count:G,mode:"compact"},null,8,["schemaName","count"]))),256)):a("",!0)])):a("",!0)]),t(e).description?(n(),u("div",de,I(("formatText"in s?s.formatText:t(A))(t(e).description)),1)):a("",!0),t(e).contributors||t(e).sponsors?(n(),u("div",pe,[t(e).contributors?(n(),_(p,{key:0,personType:"contributor",title:t(b).x_contributors(Object.keys(t(e).contributors).length),link:("PAGES"in s?s.PAGES:t(T)).contributors,persons:t(e).contributors},null,8,["title","link","persons"])):a("",!0),t(e).sponsors?(n(),_(p,{key:1,personType:"sponsor",title:t(b).x_sponsors(Object.keys(t(e).sponsors).length),link:("PAGES"in s?s.PAGES:t(T)).sponsors,persons:t(e).sponsors},null,8,["title","link","persons"])):a("",!0)])):a("",!0)]),_:1}),t(e).children?(n(),_(E,{key:0,children:t(e).children},null,8,["children"])):a("",!0)],64)}}});export{be as default};
